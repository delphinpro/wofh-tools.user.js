// ==UserScript==
// @name        Wofh Tools Client
// @namespace   http://wofh-tools.ru/
// @author      delphinpro
// @copyright   copyright (c) 2014-2016 delphinpro
// @license     Licensed under the MIT license
// @description Wofh Tools client extension
// @version     2.0.6
// @grant       none
// @include     https://w*.wofh.ru/*
// @include     http://w*.wofh.de/*
// @include     https://ru*.waysofhistory.com/*
// @include     https://en*.waysofhistory.com/*
// @exclude     https://en.waysofhistory.com/
// @exclude     https://en.waysofhistory.com/forum
// @exclude     https://en.waysofhistory.com/forum#/*
// ==/UserScript==


!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}r(1);var o=r(6),i=n(o),s=r(7),a=n(s),p=r(8),l=n(p),c=r(9),u=n(c),f=r(21),d=n(f),g=r(25),h=n(g);u["default"].drawButtonMain(),i["default"].observe("/science",function(e){e.classList.contains("-if-desk")&&u["default"].drawButtonScience(e)}),i["default"].observe("/report/([\\d]+)",function(e,t){e.classList.contains("-if-desk")&&19==window.wofh.reports[t[1]].type&&u["default"].drawButtonBattle(e,t[1])}),l["default"].ready(function(e){i["default"].start(),$(document).on("click",".js-wt-science",function(){var t=a["default"].getLogger("scilogger");l["default"].send(e,t)}),$(document).on("click",".js-wt-main",function(){return wndMgr.addSimpleWnd(d["default"].getHtml(e),"Wofh-Tools UserScript v"+h["default"],1,{moving:!0,showBack:!0,canClose:!0,noScroll:!0,setHash:!1}),!1})},h["default"]),$(document).on("click",".js-wt-battle",function(){var e=parseInt($(this).data("id")),t=window.wofh.reports[e],r=a["default"].getLogger("warlogger");l["default"].send(l["default"].formatReportBattle(t),r)})},function(e,t,r){var n=r(2);"string"==typeof n&&(n=[[e.id,n,""]]);r(5)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,r){t=e.exports=r(3)(),t.push([e.id,".wt-btn-dev-mode{position:fixed;left:0;top:20px;background:#000;color:#fff;padding:5px 10px;z-index:99999}.wt-main-button{position:relative}.wt-main-button span{position:absolute;left:0;top:0;width:100%;height:100%;background:url("+r(4)+") no-repeat 50% 50%;background-size:contain;cursor:pointer}.smenuIcon.wt-btn-main{background:url("+r(4)+");background-size:contain}.wt-options-window{text-align:left;padding:10px}.wt-options-window .wt-panel-body{padding:0 10px 10px}.wt-options-window h3{text-align:center}.wt-sections{display:-webkit-flex;display:-ms-flexbox;display:flex}.wt-sections>div{margin:5px}.wt-options-item{padding:5px;display:-webkit-flex;display:-ms-flexbox;display:flex}.wt-options-item--centered{-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.wt-options-item--between{-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between}.wt-options-item .wt-input{margin-right:10px;min-width:200px}.wt-input:after,.wt-input:before{content:none}.wt-input__inner{display:block;height:100%;position:relative;z-index:1}.wt-input input,.wt-input select{width:100%;height:30px;box-sizing:border-box;padding-left:5px;padding-right:5px}",""])},function(e,t){"use strict";e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var r=this[t];r[2]?e.push("@media "+r[2]+"{"+r[1]+"}"):e.push(r[1])}return e.join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&n[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),e.push(s))}},e}},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODJENDZGQUFDMTUxMTFFNTg3Q0VEOENERUY2MUEzNjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODJENDZGQUJDMTUxMTFFNTg3Q0VEOENERUY2MUEzNjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MkQ0NkZBOEMxNTExMUU1ODdDRUQ4Q0RFRjYxQTM2MCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4MkQ0NkZBOUMxNTExMUU1ODdDRUQ4Q0RFRjYxQTM2MCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlaDq7gAAB/2SURBVHjaxHtpkFzX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"},function(e,t,r){function n(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=d[n.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](n.parts[i]);for(;i<n.parts.length;i++)o.parts.push(l(n.parts[i],t))}else{for(var s=[],i=0;i<n.parts.length;i++)s.push(l(n.parts[i],t));d[n.id]={id:n.id,refs:1,parts:s}}}}function o(e){for(var t=[],r={},n=0;n<e.length;n++){var o=e[n],i=o[0],s=o[1],a=o[2],p=o[3],l={css:s,media:a,sourceMap:p};r[i]?r[i].parts.push(l):t.push(r[i]={id:i,parts:[l]})}return t}function i(e,t){var r=y(),n=v[v.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),v.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(t)}}function s(e){e.parentNode.removeChild(e);var t=v.indexOf(e);t>=0&&v.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function p(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function l(e,t){var r,n,o;if(t.singleton){var i=x++;r=m||(m=a(t)),n=c.bind(null,r,i,!1),o=c.bind(null,r,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=p(t),n=f.bind(null,r),o=function(){s(r),r.href&&URL.revokeObjectURL(r.href)}):(r=a(t),n=u.bind(null,r),o=function(){s(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}function c(e,t,r,n){var o=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function u(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function f(e,t){var r=t.css,n=t.sourceMap;n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([r],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var d={},g=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=g(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),y=g(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,x=0,v=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var r=o(e);return n(r,t),function(e){for(var i=[],s=0;s<r.length;s++){var a=r[s],p=d[a.id];p.refs--,i.push(p)}if(e){var l=o(e);n(l,t)}for(var s=0;s<i.length;s++){var p=i[s];if(0===p.refs){for(var c=0;c<p.parts.length;c++)p.parts[c]();delete d[p.id]}}}};var w=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={},n=[],o=null,i={childList:!0,subtree:!0};r.start=function(){if(!o){var e="";o=new MutationObserver(function(t){var r=window.location.hash.replace(/^#[\d]*/,"");if(""===r)return void(e=r);e=r;var o=void 0,i=void 0;for(var s in n)if(n.hasOwnProperty(s)){var a=new RegExp(s);if(a.test(r)){o=s,i=a.exec(r);break}}o&&!function(){var e=n[o];t.map(function(t){/mCS/.test(t.target.className)||/chat-messages/.test(t.target.className)||/js-timer/.test(t.target.className)||"function"==typeof e&&e(t.target,i)})}()}),o.observe(document.body,i)}},r.observe=function(e,t){n[e]=t},t["default"]=r},function(e,t){"use strict";function r(){var e=localStorage.getItem(o);e||(e="{}");var t=JSON.parse(e);i=$.extend(i,t)}function n(){var e=JSON.stringify(i);localStorage.setItem(o,e)}Object.defineProperty(t,"__esModule",{value:!0});var o="wofh-tools.ru",i={selectedLogger:{scilogger:"wofh-tools.ru/sci",warlogger:"wofh-tools.ru/log"},loggers:{scilogger:[],warlogger:[]}};r(),t["default"]={existsLogger:function(e,t){return i.loggers[e].indexOf(t)>-1},addLogger:function(e,t){i.loggers[e].push(t),n()},removeLogger:function(e,t){var r=i.loggers[e].indexOf(t);i.loggers[e].splice(r,1),n()},selectLogger:function(e,t){this.existsLogger(e,t)&&(i.selectedLogger[e]=t,n())},getLoggers:function(e){return i.loggers[e]},getLogger:function(e){return i.selectedLogger[e]},getData:function(){return i}}},function(e,t){"use strict";function r(e,t){e=e.replace(/-/g,"0").replace(/\*/g,"1").replace(/\+/g,"2").split("");for(var r in e)e.hasOwnProperty(r)&&r!=t&&(e[r]=parseInt(e[r]));return e}function n(e,t){var n=t.main.version,o=e.account.science.current,i=r(e.account.science.state,o),s=999!==e.account.science.next?e.account.science.next:null,a=e.account.science.inc,p=e.account.science.progress,l={account:[e.account.id,e.account.name,e.account.sex,e.account.race.id],domain:t.main.domain,generatetime:e.account.science.updated?e.account.science.updated:Math.round(+new Date/1e3),science:{current:{id:o,progress:a},next:s,known:i,started:p},version:n,country:"undefined"!=typeof e.account.country?{id:e.account.country.id,name:e.account.country.name,flag:e.account.country.flag}:null};return l}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={ready:function(e,t){var r=void 0;r=setInterval(function(){if("undefined"!=typeof servodata.account){clearInterval(r);var o=n(servodata,lib);o.usVer=t,e(o)}},100)},send:function(e,t){var r=$("<form/>",{action:"http://"+t+"/",method:"post",target:"_blank",css:{display:"none"}});$("<input/>",{type:"hidden",name:"sData",value:encodeURIComponent(JSON.stringify(e))}).appendTo(r),r.appendTo("body"),r.submit(),setTimeout(function(){r.remove()},500)},formatReportBattle:function(e){var t={};t.id=e.data.attackers[0].acc,t.name=e.data.accounts[t.id][0],t.sex=e.data.accounts[t.id][1],t.race=e.data.accounts[t.id][2],t.townId=e.data.attackers[0].town,t.townName=e.data.towns[t.townId][0];var r={};r.id=e.data.defenders?e.data.defenders[0].acc:0,r.name=r.id?e.data.accounts[r.id][0]:0,r.sex=r.id?e.data.accounts[r.id][1]:1,r.race=r.id?e.data.accounts[r.id][2]:1,r.townId=e.data.defenders?e.data.defenders[0].town:0,r.townName=r.townId?e.data.towns[r.townId][0]:"";var n={time:e.time,domain:lib.main.domain,owner:e.owner,account1:[t.id,t.name,t.sex,t.race],account2:[r.id,r.name,r.sex,r.race],code:e.code,data:{account1:[t.id,t.name,t.sex,t.race],account2:[r.id,r.name,r.sex,r.race],army1:e.data.attackers[0].army,army2:r.id?e.data.defenders[0].army:"",bonus1:e.data.attackers[0].bonus,bonus2:r.id?e.data.defenders[0].bonus:"",destroy:e.data.destroy,fullload:0,grabbed:e.data.attackers[0].robbed,killed:e.data.killed,result:e.data.result,survived1:e.data.attackers[0].survived,survived2:r.id?e.data.defenders[0].survived:"",tactics1:"",tactics2:"",wonder1:0,wonder2:0},id:e.id,read:0,town1:[t.townId,t.townName],town2:[r.townId,r.townName],type:19,isAnother:!1,templates:[]};return n},domainToSign:function(e){var t=void 0,r="en";return t=e.match(/en([\d]+)\.waysofhistory\.com/),t||(t=e.match(/ru([\d]+)\.waysofhistory\.com/),r="ru"),t||(t=e.match(/w([\d]+)\.wofh\.ru/),r="ru"),t||(t=e.match(/w([\d]+)\.wofh\.de/),r="de"),t?r+t[1]:null}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(10),i=n(o),s=r(19),a=n(s);t["default"]={drawButtonMain:function(){if($("#m2_town").size())return void this.drawButtonMainLegacy();var e=void 0;e=setInterval(function(){var t=$(".smenu-list");t.size()&&(clearInterval(e),t.append('<li><a class="smenu-itemBtn button1 js-wt-main">WofhTools</a> <a class="js-wt-main"><span class="smenuIcon wt-btn-main" data-title="WofhTools"></span></a></li>'))},100)},drawButtonMainLegacy:function(){var e=$("<div/>",{"class":"wt-main-button js-wt-main"});e.prependTo($("#m2_town").closest(".m2")),$("<span/>").appendTo(e)},drawButtonDevMode:function(){$("<a/>",{href:"/?test",text:"ENTER TO DEV MODE","class":"wt-btn-dev-mode"}).appendTo("body")},drawButtonScience:function(e){i["default"].insertToDOM(e)},drawButtonBattle:function(e,t){a["default"].insertToDOM(e,t)}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=n(o),s=r(7),a=n(s),p=r(13),l=n(p);t["default"]={insertToDOM:function(e){var t=$(e).find(".science-build-cont");if(0==t.find(".js-wt-science").size()){var r=(0,l["default"])($.extend(i["default"],{sendSciLoggerButtonClass:"js-wt-science",loggerLink:a["default"].getLogger("scilogger")}));t.append(r)}}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(12),i=n(o),s={text_HybridInterface:["Hybrid interface","Гибридный интерфейс"],text_Statistic:["Your statistics","Ваша статистика"],text_ClassicMap:["Classic map","Классическая карта"],text_Remove:["Remove","Удалить"],text_Add:["Add","Добавить"],text_ADD_SCI_HINT:["Custom address of scilogger","Адрес альтернативной науковницы"],text_ADD_WAR_HINT:["Custom address of warlogger","Адрес альтернативной логовницы"],text_ToSciLogger:["Send to SciLogger","Отправить в науковницу"],text_ToWarLogger:["Send to WarLogger","Отправить в логовницу"],text_SciLogger:["SciLogger","Науковница"],text_WarLogger:["WarLogger","Логовница"]},a="ru"==i["default"].get("lang")?1:0;for(var p in s)s.hasOwnProperty(p)&&s[p][a]&&(s[p]=s[p][a]);t["default"]=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={get:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}}},function(e,t,r){var n=r(14).twig,o=n({id:"e:\\YandexDisk\\domains\\projects\\wofh-tools\\user.js\\source\\modules\\ui\\sci-logger-button\\button.twig",data:[{type:"raw",value:'<div style="padding: 1em 0 0; text-align: center;">\n    <button class="button1 -type-green '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"sendSciLoggerButtonClass",match:["sendSciLoggerButtonClass"]}]},{type:"raw",value:'"><span>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_ToSciLogger",match:["text_ToSciLogger"]}]},{type:"raw",value:'</span></button>\n    <span class="-defVal" style="line-height: 33px;">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerLink",match:["loggerLink"]}]},{type:"raw",value:"</span>\n</div>\n"}],allowInlineIncludes:!0,rethrow:!0});e.exports=function(e){return o.render(e)}},function(e,t,r){var n;(function(e,o){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=function(e){return e.VERSION="0.8.9",e}(s||{}),s=function(e){function t(e,t){var r=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&r===e}return e.trace=!1,e.debug=!1,e.cache=!0,e.placeholders={parent:"{{|PARENT|}}"},e.indexOf=function(e,t){if(Array.prototype.hasOwnProperty("indexOf"))return e.indexOf(t);if(void 0===e||null===e)throw new TypeError;var r=Object(e),n=r.length>>>0;if(0===n)return-1;var o=0;if(arguments.length>0&&(o=Number(arguments[1]),o!==o?o=0:0!==o&&o!==1/0&&o!==-(1/0)&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=n)return-1;for(var i=o>=0?o:Math.max(n-Math.abs(o),0);i<n;i++)if(i in r&&r[i]===t)return i;return e==t?0:-1},e.forEach=function(e,t,r){if(Array.prototype.forEach)return e.forEach(t,r);var n,o;if(null==e)throw new TypeError(" this is null or not defined");var i=Object(e),s=i.length>>>0;if("[object Function]"!={}.toString.call(t))throw new TypeError(t+" is not a function");for(r&&(n=r),o=0;o<s;){var a;o in i&&(a=i[o],t.call(n,a,o,i)),o++}},e.merge=function(t,r,n){return e.forEach(Object.keys(r),function(e){(!n||e in t)&&(t[e]=r[e])}),t},e.Error=function(e){this.message=e,this.name="TwigException",this.type="TwigException"},e.Error.prototype.toString=function(){var e=this.name+": "+this.message;return e},e.log={trace:function(){e.trace&&console},debug:function(){e.debug&&console}},"undefined"!=typeof console?"undefined"!=typeof console.error?e.log.error=function(){}:"undefined"!=typeof console.log&&(e.log.error=function(){}):e.log.error=function(){},e.ChildContext=function(e){var t=function(){};return t.prototype=e,new t},e.token={},e.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw",output_whitespace_pre:"output_whitespace_pre",output_whitespace_post:"output_whitespace_post",output_whitespace_both:"output_whitespace_both",logic_whitespace_pre:"logic_whitespace_pre",logic_whitespace_post:"logic_whitespace_post",logic_whitespace_both:"logic_whitespace_both"},e.token.definitions=[{type:e.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:e.token.type.raw,open:"{% verbatim %}",close:"{% endverbatim %}"},{type:e.token.type.output_whitespace_pre,open:"{{-",close:"}}"},{type:e.token.type.output_whitespace_post,open:"{{",close:"-}}"},{type:e.token.type.output_whitespace_both,open:"{{-",close:"-}}"},{type:e.token.type.logic_whitespace_pre,open:"{%-",close:"%}"},{type:e.token.type.logic_whitespace_post,open:"{%",close:"-%}"},{type:e.token.type.logic_whitespace_both,open:"{%-",close:"-%}"},{type:e.token.type.output,open:"{{",close:"}}"},{type:e.token.type.logic,open:"{%",close:"%}"},{type:e.token.type.comment,open:"{#",close:"#}"}],e.token.strings=['"',"'"],e.token.findStart=function(t){var r,n,o,i,s={position:null,close_position:null,def:null};for(r=0;r<e.token.definitions.length;r++)n=e.token.definitions[r],o=t.indexOf(n.open),i=t.indexOf(n.close),e.log.trace("Twig.token.findStart: ","Searching for ",n.open," found at ",o),o>=0&&n.open.length!==n.close.length&&i<0||(o>=0&&(null===s.position||o<s.position)?(s.position=o,s.def=n,s.close_position=i):o>=0&&null!==s.position&&o===s.position&&(n.open.length>s.def.open.length?(s.position=o,s.def=n,s.close_position=i):n.open.length===s.def.open.length&&(n.close.length>s.def.close.length?i>=0&&i<s.close_position&&(s.position=o,s.def=n,s.close_position=i):i>=0&&i<s.close_position&&(s.position=o,s.def=n,s.close_position=i))));return delete s.close_position,s},e.token.findEnd=function(t,r,n){for(var o,i,s=null,a=!1,p=0,l=null,c=null,u=null,f=null,d=null,g=null;!a;){if(l=null,c=null,u=t.indexOf(r.close,p),!(u>=0))throw new e.Error("Unable to find closing bracket '"+r.close+"' opened near template position "+n);if(s=u,a=!0,r.type===e.token.type.comment)break;if(r.type===e.token.type.raw)break;for(i=e.token.strings.length,o=0;o<i;o+=1)d=t.indexOf(e.token.strings[o],p),d>0&&d<u&&(null===l||d<l)&&(l=d,c=e.token.strings[o]);if(null!==l)for(f=l+1,s=null,a=!1;;){if(g=t.indexOf(c,f),g<0)throw"Unclosed string in template";if("\\"!==t.substr(g-1,1)){p=g+1;break}f=g+1}}return s},e.tokenize=function(t){for(var r=[],n=0,o=null,i=null;t.length>0;)if(o=e.token.findStart(t),e.log.trace("Twig.tokenize: ","Found token: ",o),null!==o.position){if(o.position>0&&r.push({type:e.token.type.raw,value:t.substring(0,o.position)}),t=t.substr(o.position+o.def.open.length),n+=o.position+o.def.open.length,i=e.token.findEnd(t,o.def,n),e.log.trace("Twig.tokenize: ","Token ends at ",i),r.push({type:o.def.type,value:t.substring(0,i).trim()}),"\n"===t.substr(i+o.def.close.length,1))switch(o.def.type){case"logic_whitespace_pre":case"logic_whitespace_post":case"logic_whitespace_both":case"logic":i+=1}t=t.substr(i+o.def.close.length),n+=i+o.def.close.length}else r.push({type:e.token.type.raw,value:t}),t="";return r},e.compile=function(t){try{for(var r=[],n=[],o=[],i=null,s=null,a=null,p=null,l=null,c=null,u=null,f=null,d=null,g=null,h=null,y=null,m=function(t){e.expression.compile.apply(this,[t]),n.length>0?o.push(t):r.push(t)},x=function(t){if(s=e.logic.compile.apply(this,[t]),g=s.type,h=e.logic.handler[g].open,y=e.logic.handler[g].next,e.log.trace("Twig.compile: ","Compiled logic token to ",s," next is: ",y," open is : ",h),void 0!==h&&!h){if(p=n.pop(),u=e.logic.handler[p.type],e.indexOf(u.next,g)<0)throw new Error(g+" not expected after a "+p.type);p.output=p.output||[],p.output=p.output.concat(o),o=[],d={type:e.token.type.logic,token:p},n.length>0?o.push(d):r.push(d)}void 0!==y&&y.length>0?(e.log.trace("Twig.compile: ","Pushing ",s," to logic stack."),n.length>0&&(p=n.pop(),p.output=p.output||[],p.output=p.output.concat(o),n.push(p),o=[]),n.push(s)):void 0!==h&&h&&(d={type:e.token.type.logic,token:s},n.length>0?o.push(d):r.push(d))};t.length>0;){switch(i=t.shift(),l=r[r.length-1],c=o[o.length-1],f=t[0],e.log.trace("Compiling token ",i),
i.type){case e.token.type.raw:n.length>0?o.push(i):r.push(i);break;case e.token.type.logic:x.call(this,i);break;case e.token.type.comment:break;case e.token.type.output:m.call(this,i);break;case e.token.type.logic_whitespace_pre:case e.token.type.logic_whitespace_post:case e.token.type.logic_whitespace_both:case e.token.type.output_whitespace_pre:case e.token.type.output_whitespace_post:case e.token.type.output_whitespace_both:switch(i.type!==e.token.type.output_whitespace_post&&i.type!==e.token.type.logic_whitespace_post&&(l&&l.type===e.token.type.raw&&(r.pop(),null===l.value.match(/^\s*$/)&&(l.value=l.value.trim(),r.push(l))),c&&c.type===e.token.type.raw&&(o.pop(),null===c.value.match(/^\s*$/)&&(c.value=c.value.trim(),o.push(c)))),i.type){case e.token.type.output_whitespace_pre:case e.token.type.output_whitespace_post:case e.token.type.output_whitespace_both:m.call(this,i);break;case e.token.type.logic_whitespace_pre:case e.token.type.logic_whitespace_post:case e.token.type.logic_whitespace_both:x.call(this,i)}i.type!==e.token.type.output_whitespace_pre&&i.type!==e.token.type.logic_whitespace_pre&&f&&f.type===e.token.type.raw&&(t.shift(),null===f.value.match(/^\s*$/)&&(f.value=f.value.trim(),t.unshift(f)))}e.log.trace("Twig.compile: "," Output: ",r," Logic Stack: ",n," Pending Output: ",o)}if(n.length>0)throw a=n.pop(),new Error("Unable to find an end tag for "+a.type+", expecting one of "+a.next);return r}catch(v){if(e.log.error("Error compiling twig template "+this.id+": "),v.stack?e.log.error(v.stack):e.log.error(v.toString()),this.options.rethrow)throw v}},e.parse=function(t,r){try{var n=[],o=!0,i=this;return e.forEach(t,function(t){switch(e.log.debug("Twig.parse: ","Parsing token: ",t),t.type){case e.token.type.raw:n.push(e.filters.raw(t.value));break;case e.token.type.logic:var s=t.token,a=e.logic.parse.apply(i,[s,r,o]);void 0!==a.chain&&(o=a.chain),void 0!==a.context&&(r=a.context),void 0!==a.output&&n.push(a.output);break;case e.token.type.comment:break;case e.token.type.output_whitespace_pre:case e.token.type.output_whitespace_post:case e.token.type.output_whitespace_both:case e.token.type.output:e.log.debug("Twig.parse: ","Output token: ",t.stack),n.push(e.expression.parse.apply(i,[t.stack,r]))}}),e.output.apply(this,[n])}catch(s){if(e.log.error("Error parsing twig template "+this.id+": "),s.stack?e.log.error(s.stack):e.log.error(s.toString()),this.options.rethrow)throw s;if(e.debug)return s.toString()}},e.prepare=function(t){var r,n;return e.log.debug("Twig.prepare: ","Tokenizing ",t),n=e.tokenize.apply(this,[t]),e.log.debug("Twig.prepare: ","Compiling ",n),r=e.compile.apply(this,[n]),e.log.debug("Twig.prepare: ","Compiled ",r),r},e.output=function(t){if(!this.options.autoescape)return t.join("");var r="html";"string"==typeof this.options.autoescape&&(r=this.options.autoescape);var n=[];return e.forEach(t,function(t){t&&t.twig_markup!==!0&&t.twig_markup!=r&&(t=e.filters.escape(t,[r])),n.push(t)}),e.Markup(n.join(""))},e.Templates={loaders:{},parsers:{},registry:{}},e.validateId=function(t){if("prototype"===t)throw new e.Error(t+" is not a valid twig identifier");if(e.cache&&e.Templates.registry.hasOwnProperty(t))throw new e.Error("There is already a template with the ID "+t);return!0},e.Templates.registerLoader=function(t,r,n){if("function"!=typeof r)throw new e.Error("Unable to add loader for "+t+": Invalid function reference given.");n&&(r=r.bind(n)),this.loaders[t]=r},e.Templates.unRegisterLoader=function(e){this.isRegisteredLoader(e)&&delete this.loaders[e]},e.Templates.isRegisteredLoader=function(e){return this.loaders.hasOwnProperty(e)},e.Templates.registerParser=function(t,r,n){if("function"!=typeof r)throw new e.Error("Unable to add parser for "+t+": Invalid function regerence given.");n&&(r=r.bind(n)),this.parsers[t]=r},e.Templates.unRegisterParser=function(e){this.isRegisteredParser(e)&&delete this.parsers[e]},e.Templates.isRegisteredParser=function(e){return this.parsers.hasOwnProperty(e)},e.Templates.save=function(t){if(void 0===t.id)throw new e.Error("Unable to save template with no id");e.Templates.registry[t.id]=t},e.Templates.load=function(t){return e.Templates.registry.hasOwnProperty(t)?e.Templates.registry[t]:null},e.Templates.loadRemote=function(t,r,n,o){var i;return void 0===r.async&&(r.async=!0),void 0===r.id&&(r.id=t),e.cache&&e.Templates.registry.hasOwnProperty(r.id)?("function"==typeof n&&n(e.Templates.registry[r.id]),e.Templates.registry[r.id]):(r.parser=r.parser||"twig",i=this.loaders[r.method]||this.loaders.fs,i.apply(this,arguments))},e.Template=function(r){var n=r.data,o=r.id,i=r.blocks,s=r.macros||{},a=r.base,p=r.path,l=r.url,c=r.name,u=r.method,f=r.options;this.id=o,this.method=u,this.base=a,this.path=p,this.url=l,this.name=c,this.macros=s,this.options=f,this.reset(i),t("String",n)?this.tokens=e.prepare.apply(this,[n]):this.tokens=n,void 0!==o&&e.Templates.save(this)},e.Template.prototype.reset=function(t){e.log.debug("Twig.Template.reset","Reseting template "+this.id),this.blocks={},this.importedBlocks=[],this.originalBlockTokens={},this.child={blocks:t||{}},this.extend=null},e.Template.prototype.render=function(t,r){r=r||{};var n,o;if(this.context=t||{},this.reset(),r.blocks&&(this.blocks=r.blocks),r.macros&&(this.macros=r.macros),n=e.parse.apply(this,[this.tokens,this.context]),this.extend){var i;return this.options.allowInlineIncludes&&(i=e.Templates.load(this.extend),i&&(i.options=this.options)),i||(o=e.path.parsePath(this,this.extend),i=e.Templates.loadRemote(o,{method:this.getLoaderMethod(),base:this.base,async:!1,id:o,options:this.options})),this.parent=i,this.parent.render(this.context,{blocks:this.blocks})}return"blocks"==r.output?this.blocks:"macros"==r.output?this.macros:n},e.Template.prototype.importFile=function(t){var r,n;if(!this.url&&this.options.allowInlineIncludes){if(t=this.path?this.path+"/"+t:t,n=e.Templates.load(t),!n&&(n=e.Templates.loadRemote(r,{id:t,method:this.getLoaderMethod(),async:!1,options:this.options}),!n))throw new e.Error("Unable to find the template "+t);return n.options=this.options,n}return r=e.path.parsePath(this,t),n=e.Templates.loadRemote(r,{method:this.getLoaderMethod(),base:this.base,async:!1,options:this.options,id:r})},e.Template.prototype.importBlocks=function(t,r){var n=this.importFile(t),o=this.context,i=this;r=r||!1,n.render(o),e.forEach(Object.keys(n.blocks),function(e){(r||void 0===i.blocks[e])&&(i.blocks[e]=n.blocks[e],i.importedBlocks.push(e))})},e.Template.prototype.importMacros=function(t){var r=e.path.parsePath(this,t),n=e.Templates.loadRemote(r,{method:this.getLoaderMethod(),async:!1,id:r});return n},e.Template.prototype.getLoaderMethod=function(){return this.path?"fs":this.url?"ajax":this.method||"fs"},e.Template.prototype.compile=function(t){return e.compiler.compile(this,t)},e.Markup=function(e,t){return"undefined"==typeof t&&(t=!0),"string"==typeof e&&e.length>0&&(e=new String(e),e.twig_markup=t),e},e}(s||{});!function(e){e.Templates.registerLoader("ajax",function(t,r,n,o){var i,s,a=r.precompiled,p=this.parsers[r.parser]||this.parser.twig;if("undefined"==typeof XMLHttpRequest)throw new e.Error('Unsupported platform: Unable to do ajax requests because there is no "XMLHTTPRequest" implementation');return s=new XMLHttpRequest,s.onreadystatechange=function(){var l=null;4===s.readyState&&(200===s.status||window.cordova&&0==s.status?(e.log.debug("Got template ",s.responseText),l=a===!0?JSON.parse(s.responseText):s.responseText,r.url=t,r.data=l,i=p.call(this,r),"function"==typeof n&&n(i)):"function"==typeof o&&o(s))},s.open("GET",t,!!r.async),s.send(),!!r.async||i})}(s),function(e){var t,n;try{t=r(16),n=r(17)}catch(o){}e.Templates.registerLoader("fs",function(r,o,i,s){var a,p=null,l=o.precompiled,c=this.parsers[o.parser]||this.parser.twig;if(!t||!n)throw new e.Error('Unsupported platform: Unable to load from file because there is no "fs" or "path" implementation');var u=function(e,t){return e?void("function"==typeof s&&s(e)):(l===!0&&(t=JSON.parse(t)),o.data=t,o.path=o.path||r,a=c.call(this,o),void("function"==typeof i&&i(a)))};if(o.path=o.path||r,o.async)return t.stat(o.path,function(n,i){if(n||!i.isFile())throw new e.Error("Unable to find template file "+r);t.readFile(o.path,"utf8",u)}),!0;if(!t.statSync(o.path).isFile())throw new e.Error("Unable to find template file "+r);return p=t.readFileSync(o.path,"utf8"),u(void 0,p),a})}(s),function(e){e.Templates.registerParser("source",function(e){return e.data||""})}(s),function(e){e.Templates.registerParser("twig",function(t){return new e.Template(t)})}(s),function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t,r=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.push(t);return r})}();var s=function(e){e.lib={};var t=function(){function e(){var t=arguments[0],r=e.cache;return r[t]&&r.hasOwnProperty(t)||(r[t]=e.parse(t)),e.format.call(null,r[t],arguments)}function t(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function r(e,t){return Array(t+1).join(e)}var n={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};e.format=function(o,i){var s,a,p,l,c,u,f,d=1,g=o.length,h="",y=[],m=!0,x="";for(a=0;a<g;a++)if(h=t(o[a]),"string"===h)y[y.length]=o[a];else if("array"===h){if(l=o[a],l[2])for(s=i[d],p=0;p<l[2].length;p++){if(!s.hasOwnProperty(l[2][p]))throw new Error(e("[sprintf] property '%s' does not exist",l[2][p]));s=s[l[2][p]]}else s=l[1]?i[l[1]]:i[d++];if("function"==t(s)&&(s=s()),n.not_string.test(l[8])&&n.not_json.test(l[8])&&"number"!=t(s)&&isNaN(s))throw new TypeError(e("[sprintf] expecting number but found %s",t(s)));switch(n.number.test(l[8])&&(m=s>=0),l[8]){case"b":s=s.toString(2);break;case"c":s=String.fromCharCode(s);break;case"d":case"i":s=parseInt(s,10);break;case"j":s=JSON.stringify(s,null,l[6]?parseInt(l[6]):0);break;case"e":s=l[7]?s.toExponential(l[7]):s.toExponential();break;case"f":s=l[7]?parseFloat(s).toFixed(l[7]):parseFloat(s);break;case"g":s=l[7]?parseFloat(s).toPrecision(l[7]):parseFloat(s);break;case"o":s=s.toString(8);break;case"s":s=(s=String(s))&&l[7]?s.substring(0,l[7]):s;break;case"u":s>>>=0;break;case"x":s=s.toString(16);break;case"X":s=s.toString(16).toUpperCase()}n.json.test(l[8])?y[y.length]=s:(!n.number.test(l[8])||m&&!l[3]?x="":(x=m?"+":"-",s=s.toString().replace(n.sign,"")),u=l[4]?"0"===l[4]?"0":l[4].charAt(1):" ",f=l[6]-(x+s).length,c=l[6]&&f>0?r(u,f):"",y[y.length]=l[5]?x+s+c:"0"===u?x+c+s:c+x+s)}return y.join("")},e.cache={},e.parse=function(e){for(var t=e,r=[],o=[],i=0;t;){if(null!==(r=n.text.exec(t)))o[o.length]=r[0];else if(null!==(r=n.modulo.exec(t)))o[o.length]="%";else{if(null===(r=n.placeholder.exec(t)))throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){i|=1;var s=[],a=r[2],p=[];if(null===(p=n.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(s[s.length]=p[1];""!==(a=a.substring(p[0].length));)if(null!==(p=n.key_access.exec(a)))s[s.length]=p[1];else{if(null===(p=n.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");s[s.length]=p[1]}r[2]=s}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");o[o.length]=r}t=t.substring(r[0].length)}return o};var o=function(t,r,n){return n=(r||[]).slice(0),n.splice(0,0,t),e.apply(null,n)};return{sprintf:e,vsprintf:o}}(),r=t.sprintf,n=t.vsprintf;return e.lib.sprintf=r,e.lib.vsprintf=n,function(){function t(e){return(e=Math.abs(e)%100)%10==1&&11!=e?"st":e%10==2&&12!=e?"nd":e%10==3&&13!=e?"rd":"th"}function r(e){var t=new Date(e.getFullYear()+1,0,4);return(t-e)/864e5<7&&(e.getDay()+6)%7<(t.getDay()+6)%7?t.getFullYear():e.getMonth()>0||e.getDate()>=4?e.getFullYear():e.getFullYear()-((e.getDay()+6)%7-e.getDate()>2?1:0)}function n(e){var t=new Date(r(e),0,4);return t.setDate(t.getDate()-(t.getDay()+6)%7),parseInt((e-t)/6048e5)+1}var o="Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),i="Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),s="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),a="January,February,March,April,May,June,July,August,September,October,November,December".split(",");e.lib.formatDate=function(e,p){if("string"!=typeof p||/^\s*$/.test(p))return e+"";var l=new Date(e.getFullYear(),0,1),c=e;return p.replace(/[dDjlNSwzWFmMntLoYyaABgGhHisuU]/g,function(e){switch(e){case"d":return("0"+c.getDate()).replace(/^.+(..)$/,"$1");case"D":return o[c.getDay()];case"j":return c.getDate();case"l":return i[c.getDay()];case"N":return(c.getDay()+6)%7+1;case"S":return t(c.getDate());case"w":return c.getDay();case"z":return Math.ceil((l-c)/864e5);case"W":return("0"+n(c)).replace(/^.(..)$/,"$1");case"F":return a[c.getMonth()];case"m":return("0"+(c.getMonth()+1)).replace(/^.+(..)$/,"$1");case"M":return s[c.getMonth()];case"n":return c.getMonth()+1;case"t":return new Date(c.getFullYear(),c.getMonth()+1,(-1)).getDate();case"L":return 29==new Date(c.getFullYear(),1,29).getDate()?1:0;case"o":return r(c);case"Y":return c.getFullYear();case"y":return(c.getFullYear()+"").replace(/^.+(..)$/,"$1");case"a":return c.getHours()<12?"am":"pm";case"A":return c.getHours()<12?"AM":"PM";case"B":return Math.floor(1e3*((c.getUTCHours()+1)%24+c.getUTCMinutes()/60+c.getUTCSeconds()/3600)/24);case"g":return c.getHours()%12!=0?c.getHours()%12:12;case"G":return c.getHours();case"h":return("0"+(c.getHours()%12!=0?c.getHours()%12:12)).replace(/^.+(..)$/,"$1");case"H":return("0"+c.getHours()).replace(/^.+(..)$/,"$1");case"i":return("0"+c.getMinutes()).replace(/^.+(..)$/,"$1");case"s":return("0"+c.getSeconds()).replace(/^.+(..)$/,"$1");case"u":return c.getMilliseconds();case"U":return c.getTime()/1e3}})}}(),e.lib.strip_tags=function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var r=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,n=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(n,"").replace(r,function(e,r){return t.indexOf("<"+r.toLowerCase()+">")>-1?e:""})},e.lib.parseISO8601Date=function(e){var t=/(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d+)?(Z|([+-])(\d\d):(\d\d))/,r=[];if(r=e.match(t),!r)throw"Couldn't parse ISO 8601 date string '"+e+"'";var n=[1,2,3,4,5,6,10,11];for(var o in n)r[n[o]]=parseInt(r[n[o]],10);r[7]=parseFloat(r[7]);var i=Date.UTC(r[1],r[2]-1,r[3],r[4],r[5],r[6]);if(r[7]>0&&(i+=Math.round(1e3*r[7])),"Z"!=r[8]&&r[10]){var s=60*r[10]*60*1e3;r[11]&&(s+=60*r[11]*1e3),"-"==r[9]?i-=s:i+=s}return new Date(i)},e.lib.strtotime=function(e,t){function r(e,t,r){var n,o=l[t];"undefined"!=typeof o&&(n=o-p.getDay(),0===n?n=7*r:n>0&&"last"===e?n-=7:n<0&&"next"===e&&(n+=7),p.setDate(p.getDate()+n))}function n(e){var t=e.split(" "),n=t[0],o=t[1].substring(0,3),i=/\d+/.test(n),s="ago"===t[2],a=("last"===n?-1:1)*(s?-1:1);if(i&&(a*=parseInt(n,10)),c.hasOwnProperty(o)&&!t[1].match(/^mon(day|\.)?$/i))return p["set"+c[o]](p["get"+c[o]]()+a);if("wee"===o)return p.setDate(p.getDate()+7*a);if("next"===n||"last"===n)r(n,o,a);else if(!i)return!1;return!0}var o,i,s,a,p,l,c,u,f,d,g,h=!1;if(!e)return h;if(e=e.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase(),i=e.match(/^(\d{1,4})([\-\.\/\:])(\d{1,2})([\-\.\/\:])(\d{1,4})(?:\s(\d{1,2}):(\d{2})?:?(\d{2})?)?(?:\s([A-Z]+)?)?$/),i&&i[2]===i[4])if(i[1]>1901)switch(i[2]){case"-":return i[3]>12||i[5]>31?h:new Date(i[1],parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case".":return h;case"/":return i[3]>12||i[5]>31?h:new Date(i[1],parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3}else if(i[5]>1901)switch(i[2]){case"-":return i[3]>12||i[1]>31?h:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case".":return i[3]>12||i[1]>31?h:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3;case"/":return i[1]>12||i[3]>31?h:new Date(i[5],parseInt(i[1],10)-1,i[3],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3}else switch(i[2]){case"-":return i[3]>12||i[5]>31||i[1]<70&&i[1]>38?h:(a=i[1]>=0&&i[1]<=38?+i[1]+2e3:i[1],new Date(a,parseInt(i[3],10)-1,i[5],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3);case".":return i[5]>=70?i[3]>12||i[1]>31?h:new Date(i[5],parseInt(i[3],10)-1,i[1],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3:i[5]<60&&!i[6]?i[1]>23||i[3]>59?h:(s=new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),i[1]||0,i[3]||0,i[5]||0,i[9]||0)/1e3):h;case"/":return i[1]>12||i[3]>31||i[5]<70&&i[5]>38?h:(a=i[5]>=0&&i[5]<=38?+i[5]+2e3:i[5],new Date(a,parseInt(i[1],10)-1,i[3],i[6]||0,i[7]||0,i[8]||0,i[9]||0)/1e3);case":":return i[1]>23||i[3]>59||i[5]>59?h:(s=new Date,new Date(s.getFullYear(),s.getMonth(),s.getDate(),i[1]||0,i[3]||0,i[5]||0)/1e3)}if("now"===e)return null===t||isNaN(t)?(new Date).getTime()/1e3|0:0|t;if(!isNaN(o=Date.parse(e)))return o/1e3|0;if((i=e.match(/^([0-9]{4}-[0-9]{2}-[0-9]{2})[ t]([0-9]{2}:[0-9]{2}:[0-9]{2}(\.[0-9]+)?)([\+-][0-9]{2}(:[0-9]{2})?|z)/))&&("z"==i[4]?i[4]="Z":i[4].match(/^([\+-][0-9]{2})$/)&&(i[4]=i[4]+":00"),!isNaN(o=Date.parse(i[1]+"T"+i[2]+i[4]))))return o/1e3|0;if(p=t?new Date(1e3*t):new Date,l={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},c={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"},f="(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)",d="([+-]?\\d+\\s"+f+"|(last|next)\\s"+f+")(\\sago)?",i=e.match(new RegExp(d,"gi")),!i)return h;for(g=0,u=i.length;g<u;g++)if(!n(i[g]))return h;return p.getTime()/1e3},e.lib.is=function(e,t){var r=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&r===e},e.lib.copy=function(e){var t,r={};for(t in e)r[t]=e[t];return r},e.lib.replaceAll=function(e,t,r){return e.split(t).join(r)},e.lib.chunkArray=function(t,r){var n=[],o=0,i=t.length;if(r<1||!e.lib.is("Array",t))return[];for(;o<i;)n.push(t.slice(o,o+=r));return n},e.lib.round=function(e,t,r){var n,o,i,s;if(t|=0,n=Math.pow(10,t),e*=n,s=e>0|-(e<0),i=e%1===.5*s,o=Math.floor(e),i)switch(r){case"PHP_ROUND_HALF_DOWN":e=o+(s<0);break;case"PHP_ROUND_HALF_EVEN":e=o+o%2*s;break;case"PHP_ROUND_HALF_ODD":e=o+!(o%2);break;default:e=o+(s>0)}return(i?e:Math.round(e))/n},e.lib.max=function(){var e,t,r=0,n=0,o=arguments,s=o.length,a=function(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t},p=function l(e,t){var r=0,n=0,o=0,s=0,p=0;if(e===t)return 0;if("object"===("undefined"==typeof e?"undefined":i(e))){if("object"===("undefined"==typeof t?"undefined":i(t))){if(e=a(e),t=a(t),p=e.length,s=t.length,s>p)return 1;if(s<p)return-1;for(r=0,n=p;r<n;++r){if(o=l(e[r],t[r]),1==o)return 1;if(o==-1)return-1}return 0}return-1}return"object"===("undefined"==typeof t?"undefined":i(t))?1:isNaN(t)&&!isNaN(e)?0==e?0:e<0?1:-1:isNaN(e)&&!isNaN(t)?0==t?0:t>0?1:-1:t==e?0:t>e?1:-1};if(0===s)throw new Error("At least one value should be passed to max()");if(1===s){if("object"!==i(o[0]))throw new Error("Wrong parameter count for max()");if(e=a(o[0]),0===e.length)throw new Error("Array must contain at least one element for max()")}else e=o;for(t=e[0],r=1,n=e.length;r<n;++r)1==p(t,e[r])&&(t=e[r]);return t},e.lib.min=function(){var e,t,r=0,n=0,o=arguments,s=o.length,a=function(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t},p=function l(e,t){var r=0,n=0,o=0,s=0,p=0;if(e===t)return 0;if("object"===("undefined"==typeof e?"undefined":i(e))){if("object"===("undefined"==typeof t?"undefined":i(t))){if(e=a(e),t=a(t),p=e.length,s=t.length,s>p)return 1;if(s<p)return-1;for(r=0,n=p;r<n;++r){if(o=l(e[r],t[r]),1==o)return 1;if(o==-1)return-1}return 0}return-1}return"object"===("undefined"==typeof t?"undefined":i(t))?1:isNaN(t)&&!isNaN(e)?0==e?0:e<0?1:-1:isNaN(e)&&!isNaN(t)?0==t?0:t>0?1:-1:t==e?0:t>e?1:-1};if(0===s)throw new Error("At least one value should be passed to min()");if(1===s){if("object"!==i(o[0]))throw new Error("Wrong parameter count for min()");if(e=a(o[0]),0===e.length)throw new Error("Array must contain at least one element for min()")}else e=o;for(t=e[0],r=1,n=e.length;r<n;++r)p(t,e[r])==-1&&(t=e[r]);return t},e}(s||{}),s=function(e){for(e.logic={},e.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",shortblock:"Twig.logic.type.shortblock",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from",embed:"Twig.logic.type.embed",endembed:"Twig.logic.type.endembed"},e.logic.definitions=[{type:e.logic.type.if_,regex:/^if\s+([\s\S]+)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!0,compile:function(t){var r=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,delete t.match,t},parse:function(t,r,n){var o="",i=e.expression.parse.apply(this,[t.stack,r]);return n=!0,i&&(n=!1,o=e.parse.apply(this,[t.output,r])),{chain:n,output:o}}},{type:e.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[e.logic.type.else_,e.logic.type.elseif,e.logic.type.endif],open:!1,compile:function(t){var r=t.match[1];return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,delete t.match,t},parse:function(t,r,n){var o="";return n&&e.expression.parse.apply(this,[t.stack,r])===!0&&(n=!1,o=e.parse.apply(this,[t.output,r])),{chain:n,output:o}}},{type:e.logic.type.else_,regex:/^else$/,next:[e.logic.type.endif,e.logic.type.endfor],open:!1,parse:function(t,r,n){var o="";return n&&(o=e.parse.apply(this,[t.output,r])),{chain:n,output:o}}},{type:e.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:e.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([^\s].*?)(?:\s+if\s+([^\s].*))?$/,next:[e.logic.type.else_,e.logic.type.endfor],open:!0,compile:function(t){var r=t.match[1],n=t.match[2],o=t.match[3],i=null;if(t.key_var=null,t.value_var=null,r.indexOf(",")>=0){if(i=r.split(","),2!==i.length)throw new e.Error("Invalid expression in for loop: "+r);t.key_var=i[0].trim(),t.value_var=i[1].trim()}else t.value_var=r;return t.expression=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack,o&&(t.conditional=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:o}]).stack),delete t.match,t},parse:function(t,r,n){var o,i,s=e.expression.parse.apply(this,[t.expression,r]),a=[],p=0,l=this,c=t.conditional,u=function(e,t){var n=void 0!==c;return{index:e+1,index0:e,revindex:n?void 0:t-e,revindex0:n?void 0:t-e-1,first:0===e,last:n?void 0:e===t-1,length:n?void 0:t,parent:r}},f=function(n,i){var s=e.ChildContext(r);s[t.value_var]=i,t.key_var&&(s[t.key_var]=n),s.loop=u(p,o),(void 0===c||e.expression.parse.apply(l,[c,s]))&&(a.push(e.parse.apply(l,[t.output,s])),p+=1),delete s.loop,delete s[t.value_var],delete s[t.key_var],e.merge(r,s,!0)};return e.lib.is("Array",s)?(o=s.length,e.forEach(s,function(e){var t=p;f(t,e)})):e.lib.is("Object",s)&&(i=void 0!==s._keys?s._keys:Object.keys(s),o=i.length,e.forEach(i,function(e){"_keys"!==e&&f(e,s[e])})),n=0===a.length,{chain:n,output:e.output.apply(this,[a])}}},{type:e.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:e.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*([\s\S]+)$/,next:[],open:!0,compile:function(t){var r=t.match[1].trim(),n=t.match[2],o=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:n}]).stack;return t.key=r,t.expression=o,delete t.match,t},parse:function(t,r,n){var o=e.expression.parse.apply(this,[t.expression,r]),i=t.key;return r[i]=o,{chain:n,context:r}}},{type:e.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[e.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(t,r,n){var o=e.parse.apply(this,[t.output,r]),i=t.key;return this.context[i]=o,r[i]=o,{chain:n,context:r}}},{type:e.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:e.logic.type.filter,regex:/^filter\s+(.+)$/,next:[e.logic.type.endfilter],open:!0,compile:function(t){var r="|"+t.match[1].trim();return t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,delete t.match,t},parse:function(t,r,n){var o=e.parse.apply(this,[t.output,r]),i=[{type:e.expression.type.string,value:o}].concat(t.stack),s=e.expression.parse.apply(this,[i,r]);return{chain:n,output:s}}},{type:e.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:e.logic.type.block,regex:/^block\s+([a-zA-Z0-9_]+)$/,next:[e.logic.type.endblock],open:!0,compile:function(e){return e.block=e.match[1].trim(),delete e.match,e},parse:function(t,r,n){var o,i,s=e.indexOf(this.importedBlocks,t.block)>-1,a=this.blocks[t.block]&&e.indexOf(this.blocks[t.block],e.placeholders.parent)>-1;return(void 0===this.blocks[t.block]||s||a||r.loop||t.overwrite)&&(o=t.expression?e.expression.parse.apply(this,[{type:e.expression.type.string,value:e.expression.parse.apply(this,[t.output,r])},r]):e.expression.parse.apply(this,[{type:e.expression.type.string,value:e.parse.apply(this,[t.output,r])},r]),s&&this.importedBlocks.splice(this.importedBlocks.indexOf(t.block),1),a?this.blocks[t.block]=e.Markup(this.blocks[t.block].replace(e.placeholders.parent,o)):this.blocks[t.block]=o,this.originalBlockTokens[t.block]={type:t.type,block:t.block,output:t.output,overwrite:!0}),i=this.child.blocks[t.block]?this.child.blocks[t.block]:this.blocks[t.block],{chain:n,output:i}}},{type:e.logic.type.shortblock,regex:/^block\s+([a-zA-Z0-9_]+)\s+(.+)$/,next:[],open:!0,compile:function(t){return t.expression=t.match[2].trim(),t.output=e.expression.compile({type:e.expression.type.expression,value:t.expression}).stack,t.block=t.match[1].trim(),delete t.match,t},parse:function(t,r,n){return e.logic.handler[e.logic.type.block].parse.apply(this,arguments)}},{type:e.logic.type.endblock,regex:/^endblock(?:\s+([a-zA-Z0-9_]+))?$/,next:[],open:!1},{type:e.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(t){var r=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,t},parse:function(t,r,n){var o=e.expression.parse.apply(this,[t.stack,r]);return this.extend=o,{chain:n,output:""}}},{type:e.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(t){var r=t.match[1].trim();return delete t.match,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,t},parse:function(t,r,n){var o=e.expression.parse.apply(this,[t.stack,r]);return this.importBlocks(o),{chain:n,output:""}}},{type:e.logic.type.include,regex:/^include\s+(ignore missing\s+)?(.+?)\s*(?:with\s+([\S\s]+?))?\s*(only)?$/,next:[],open:!0,compile:function(t){var r=t.match,n=void 0!==r[1],o=r[2].trim(),i=r[3],s=void 0!==r[4]&&r[4].length;return delete t.match,t.only=s,t.includeMissing=n,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:o}]).stack,void 0!==i&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i.trim()}]).stack),t},parse:function(t,r,n){var o,i,s,a={};if(t.only||(a=e.ChildContext(r)),void 0!==t.withStack){o=e.expression.parse.apply(this,[t.withStack,r]);for(i in o)o.hasOwnProperty(i)&&(a[i]=o[i])}var p=e.expression.parse.apply(this,[t.stack,a]);return s=p instanceof e.Template?p:this.importFile(p),{chain:n,output:s.render(a)}}},{type:e.logic.type.spaceless,regex:/^spaceless$/,next:[e.logic.type.endspaceless],open:!0,parse:function(t,r,n){var o=e.parse.apply(this,[t.output,r]),i=/>\s+</g,s=o.replace(i,"><").trim();return{chain:n,output:s}}},{type:e.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:e.logic.type.macro,regex:/^macro\s+([a-zA-Z0-9_]+)\s*\(\s*((?:[a-zA-Z0-9_]+(?:,\s*)?)*)\s*\)$/,next:[e.logic.type.endmacro],open:!0,compile:function(t){for(var r=t.match[1],n=t.match[2].split(/[\s,]+/),o=0;o<n.length;o++)for(var i=0;i<n.length;i++)if(n[o]===n[i]&&o!==i)throw new e.Error("Duplicate arguments for parameter: "+n[o]);return t.macroName=r,t.parameters=n,delete t.match,t},parse:function(t,r,n){var o=this;return this.macros[t.macroName]=function(){for(var r={_self:o.macros},n=0;n<t.parameters.length;n++){var i=t.parameters[n];"undefined"!=typeof arguments[n]?r[i]=arguments[n]:r[i]=void 0}return e.parse.apply(o,[t.output,r])},{chain:n,output:""}}},{type:e.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:e.logic.type.import_,regex:/^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,next:[],open:!0,compile:function(t){var r=t.match[1].trim(),n=t.match[2].trim();return delete t.match,t.expression=r,t.contextName=n,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,t},parse:function(t,r,n){if("_self"!==t.expression){var o=e.expression.parse.apply(this,[t.stack,r]),i=this.importFile(o||t.expression);r[t.contextName]=i.render({},{output:"macros"})}else r[t.contextName]=this.macros;return{chain:n,output:""}}},{type:e.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(t){for(var r=t.match[1].trim(),n=t.match[2].trim().split(/[ ,]+/),o={},i=0;i<n.length;i++){var s=n[i],a=s.match(/^([a-zA-Z0-9_]+)\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/);a?o[a[1].trim()]=a[2].trim():s.match(/^([a-zA-Z0-9_]+)$/)&&(o[s]=s)}return delete t.match,t.expression=r,t.macroNames=o,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:r}]).stack,t},parse:function(t,r,n){var o;if("_self"!==t.expression){var i=e.expression.parse.apply(this,[t.stack,r]),s=this.importFile(i||t.expression);o=s.render({},{output:"macros"})}else o=this.macros;for(var a in t.macroNames)o.hasOwnProperty(a)&&(r[t.macroNames[a]]=o[a]);return{chain:n,output:""}}},{type:e.logic.type.embed,regex:/^embed\s+(ignore missing\s+)?(.+?)\s*(?:with\s+(.+?))?\s*(only)?$/,next:[e.logic.type.endembed],open:!0,compile:function(t){var r=t.match,n=void 0!==r[1],o=r[2].trim(),i=r[3],s=void 0!==r[4]&&r[4].length;return delete t.match,t.only=s,t.includeMissing=n,t.stack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:o}]).stack,void 0!==i&&(t.withStack=e.expression.compile.apply(this,[{type:e.expression.type.expression,value:i.trim()}]).stack),t},parse:function(t,r,n){var o,i,s,a={};if(!t.only)for(i in r)r.hasOwnProperty(i)&&(a[i]=r[i]);if(void 0!==t.withStack){o=e.expression.parse.apply(this,[t.withStack,r]);for(i in o)o.hasOwnProperty(i)&&(a[i]=o[i])}var p=e.expression.parse.apply(this,[t.stack,a]);s=p instanceof e.Template?p:this.importFile(p),this.blocks={};e.parse.apply(this,[t.output,a]);return{chain:n,output:s.render(a,{blocks:this.blocks})}}},{type:e.logic.type.endembed,regex:/^endembed$/,next:[],open:!1}],e.logic.handler={},e.logic.extendType=function(t,r){r=r||"Twig.logic.type"+t,e.logic.type[t]=r},e.logic.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.logic.extendType(t.type),e.logic.handler[t.type]=t};e.logic.definitions.length>0;)e.logic.extend(e.logic.definitions.shift());return e.logic.compile=function(t){
var r=t.value.trim(),n=e.logic.tokenize.apply(this,[r]),o=e.logic.handler[n.type];return o.compile&&(n=o.compile.apply(this,[n]),e.log.trace("Twig.logic.compile: ","Compiled logic token to ",n)),n},e.logic.tokenize=function(t){var r={},n=null,o=null,i=null,s=null,a=null,p=null;t=t.trim();for(n in e.logic.handler)if(e.logic.handler.hasOwnProperty(n))for(o=e.logic.handler[n].type,i=e.logic.handler[n].regex,s=[],i instanceof Array?s=i:s.push(i);s.length>0;)if(a=s.shift(),p=a.exec(t.trim()),null!==p)return r.type=o,r.match=p,e.log.trace("Twig.logic.tokenize: ","Matched a ",o," regular expression of ",p),r;throw new e.Error("Unable to parse '"+t.trim()+"'")},e.logic.parse=function(t,r,n){var o,i="";return r=r||{},e.log.debug("Twig.logic.parse: ","Parsing logic token ",t),o=e.logic.handler[t.type],o.parse&&(i=o.parse.apply(this,[t,r,n])),i},e}(s||{}),s=function(e){e.expression={},e.expression.reservedWords=["true","false","null","TRUE","FALSE","NULL","_context"],e.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},e.expression.set={operations:[e.expression.type.filter,e.expression.type.operator.unary,e.expression.type.operator.binary,e.expression.type.array.end,e.expression.type.object.end,e.expression.type.parameter.end,e.expression.type.comma,e.expression.type.test],expressions:[e.expression.type._function,e.expression.type.bool,e.expression.type.string,e.expression.type.variable,e.expression.type.number,e.expression.type._null,e.expression.type.context,e.expression.type.parameter.start,e.expression.type.array.start,e.expression.type.object.start]},e.expression.set.operations_extended=e.expression.set.operations.concat([e.expression.type.key.period,e.expression.type.key.brackets]),e.expression.fn={compile:{push:function(e,t,r){r.push(e)},push_both:function(e,t,r){r.push(e),t.push(e)}},parse:{push:function(e,t,r){t.push(e)},push_value:function(e,t,r){t.push(e.value)}}},e.expression.definitions=[{type:e.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*)/,next:e.expression.set.operations.concat([e.expression.type.parameter.start]),compile:function(e,t,r){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,r.push(e)},parse:function(t,r,n){var o=r.pop(),i=t.params&&e.expression.parse.apply(this,[t.params,n]),s=e.test(t.filter,o,i);"not"==t.modifier?r.push(!s):r.push(s)}},{type:e.expression.type.comma,regex:/^,/,next:e.expression.set.expressions.concat([e.expression.type.array.end,e.expression.type.object.end]),compile:function(t,r,n){var o,i=r.length-1;for(delete t.match,delete t.value;i>=0;i--){if(o=r.pop(),o.type===e.expression.type.object.start||o.type===e.expression.type.parameter.start||o.type===e.expression.type.array.start){r.push(o);break}n.push(o)}n.push(t)}},{type:e.expression.type.operator.binary,regex:/(^[\+\-~%\?\:]|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^and\s+|^or\s+|^in\s+|^not in\s+|^\.\.)/,next:e.expression.set.expressions.concat([e.expression.type.operator.unary]),compile:function(t,r,n){delete t.match,t.value=t.value.trim();var o=t.value,i=e.expression.operator.lookup(o,t);for(e.log.trace("Twig.expression.compile: ","Operator: ",i," from ",o);r.length>0&&(r[r.length-1].type==e.expression.type.operator.unary||r[r.length-1].type==e.expression.type.operator.binary)&&(i.associativity===e.expression.operator.leftToRight&&i.precidence>=r[r.length-1].precidence||i.associativity===e.expression.operator.rightToLeft&&i.precidence>r[r.length-1].precidence);){var s=r.pop();n.push(s)}if(":"===o){if(!r[r.length-1]||"?"!==r[r.length-1].value){var a=n.pop();if(a.type===e.expression.type.string||a.type===e.expression.type.variable)t.key=a.value;else if(a.type===e.expression.type.number)t.key=a.value.toString();else{if(a.type!==e.expression.type.parameter.end||!a.expression)throw new e.Error("Unexpected value before ':' of "+a.type+" = "+a.value);t.params=a.params}return void n.push(t)}}else r.push(i)},parse:function(t,r,n){t.key?r.push(t):t.params?(t.key=e.expression.parse.apply(this,[t.params,n]),r.push(t),delete t.params):e.expression.operator.parse(t.value,r)}},{type:e.expression.type.operator.unary,regex:/(^not\s+)/,next:e.expression.set.expressions,compile:function(t,r,n){delete t.match,t.value=t.value.trim();var o=t.value,i=e.expression.operator.lookup(o,t);for(e.log.trace("Twig.expression.compile: ","Operator: ",i," from ",o);r.length>0&&(r[r.length-1].type==e.expression.type.operator.unary||r[r.length-1].type==e.expression.type.operator.binary)&&(i.associativity===e.expression.operator.leftToRight&&i.precidence>=r[r.length-1].precidence||i.associativity===e.expression.operator.rightToLeft&&i.precidence>r[r.length-1].precidence);){var s=r.pop();n.push(s)}r.push(i)},parse:function(t,r,n){e.expression.operator.parse(t.value,r)}},{type:e.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2[\s\S])*?\1/,next:e.expression.set.operations,compile:function(t,r,n){var o=t.value;delete t.match,o='"'===o.substring(0,1)?o.replace('\\"','"'):o.replace("\\'","'"),t.value=o.substring(1,o.length-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),e.log.trace("Twig.expression.compile: ","String value: ",t.value),n.push(t)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.parameter.start,regex:/^\(/,next:e.expression.set.expressions.concat([e.expression.type.parameter.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.parameter.end,regex:/^\)/,next:e.expression.set.operations_extended,compile:function(t,r,n){var o,i=t;for(o=r.pop();r.length>0&&o.type!=e.expression.type.parameter.start;)n.push(o),o=r.pop();for(var s=[];t.type!==e.expression.type.parameter.start;)s.unshift(t),t=n.pop();s.unshift(t);t=n[n.length-1],void 0===t||t.type!==e.expression.type._function&&t.type!==e.expression.type.filter&&t.type!==e.expression.type.test&&t.type!==e.expression.type.key.brackets&&t.type!==e.expression.type.key.period?(i.expression=!0,s.pop(),s.shift(),i.params=s,n.push(i)):(i.expression=!1,t.params=s)},parse:function(t,r,n){var o=[],i=!1,s=null;if(t.expression)s=e.expression.parse.apply(this,[t.params,n]),r.push(s);else{for(;r.length>0;){if(s=r.pop(),s&&s.type&&s.type==e.expression.type.parameter.start){i=!0;break}o.unshift(s)}if(!i)throw new e.Error("Expected end of parameter set.");r.push(o)}}},{type:e.expression.type.array.start,regex:/^\[/,next:e.expression.set.expressions.concat([e.expression.type.array.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.array.end,regex:/^\]/,next:e.expression.set.operations_extended,compile:function(t,r,n){for(var o,i=r.length-1;i>=0&&(o=r.pop(),o.type!==e.expression.type.array.start);i--)n.push(o);n.push(t)},parse:function(t,r,n){for(var o=[],i=!1,s=null;r.length>0;){if(s=r.pop(),s.type&&s.type==e.expression.type.array.start){i=!0;break}o.unshift(s)}if(!i)throw new e.Error("Expected end of array.");r.push(o)}},{type:e.expression.type.object.start,regex:/^\{/,next:e.expression.set.expressions.concat([e.expression.type.object.end]),compile:e.expression.fn.compile.push_both,parse:e.expression.fn.parse.push},{type:e.expression.type.object.end,regex:/^\}/,next:e.expression.set.operations_extended,compile:function(t,r,n){for(var o,i=r.length-1;i>=0&&(o=r.pop(),!o||o.type!==e.expression.type.object.start);i--)n.push(o);n.push(t)},parse:function(t,r,n){for(var o={},i=!1,s=null,a=!1,p=null;r.length>0;){if(s=r.pop(),s&&s.type&&s.type===e.expression.type.object.start){i=!0;break}if(s&&s.type&&(s.type===e.expression.type.operator.binary||s.type===e.expression.type.operator.unary)&&s.key){if(!a)throw new e.Error("Missing value for key '"+s.key+"' in object definition.");o[s.key]=p,void 0===o._keys&&(o._keys=[]),o._keys.unshift(s.key),p=null,a=!1}else a=!0,p=s}if(!i)throw new e.Error("Unexpected end of object.");r.push(o)}},{type:e.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,r){e.value=e.match[1],r.push(e)},parse:function(t,r,n){var o=r.pop(),i=t.params&&e.expression.parse.apply(this,[t.params,n]);r.push(e.filter.apply(this,[t.value,o,i]))}},{type:e.expression.type._function,regex:/^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,next:e.expression.type.parameter.start,transform:function(e,t){return"("},compile:function(e,t,r){var n=e.match[1];e.fn=n,delete e.match,delete e.value,r.push(e)},parse:function(t,r,n){var o,i=t.params&&e.expression.parse.apply(this,[t.params,n]),s=t.fn;if(e.functions[s])o=e.functions[s].apply(this,i);else{if("function"!=typeof n[s])throw new e.Error(s+" function does not exist and is not defined in the context");o=n[s].apply(n,i)}r.push(o)}},{type:e.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,validate:function(t,r){return e.indexOf(e.expression.reservedWords,t[0])<0},parse:function(t,r,n){var o=e.expression.resolve(n[t.value],n);r.push(o)}},{type:e.expression.type.key.period,regex:/^\.([a-zA-Z0-9_]+)/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(e,t,r){e.key=e.match[1],delete e.match,delete e.value,r.push(e)},parse:function(t,r,n){var o,s=t.params&&e.expression.parse.apply(this,[t.params,n]),a=t.key,p=r.pop();if(null===p||void 0===p){if(this.options.strict_variables)throw new e.Error("Can't access a key "+a+" on an null or undefined object.");return null}var l=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)};o="object"===("undefined"==typeof p?"undefined":i(p))&&a in p?p[a]:void 0!==p["get"+l(a)]?p["get"+l(a)]:void 0!==p["is"+l(a)]?p["is"+l(a)]:void 0,r.push(e.expression.resolve(o,p,s))}},{type:e.expression.type.key.brackets,regex:/^\[([^\]]*)\]/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:function(t,r,n){var o=t.match[1];delete t.value,delete t.match,t.stack=e.expression.compile({value:o}).stack,n.push(t)},parse:function(t,r,n){var o,s=t.params&&e.expression.parse.apply(this,[t.params,n]),a=e.expression.parse.apply(this,[t.stack,n]),p=r.pop();if(null===p||void 0===p){if(this.options.strict_variables)throw new e.Error("Can't access a key "+a+" on an null or undefined object.");return null}o="object"===("undefined"==typeof p?"undefined":i(p))&&a in p?p[a]:null,r.push(e.expression.resolve(o,p,s))}},{type:e.expression.type._null,regex:/^(null|NULL|none|NONE)/,next:e.expression.set.operations,compile:function(e,t,r){delete e.match,e.value=null,r.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.context,regex:/^_context/,next:e.expression.set.operations_extended.concat([e.expression.type.parameter.start]),compile:e.expression.fn.compile.push,parse:function(e,t,r){t.push(r)}},{type:e.expression.type.number,regex:/^\-?\d+(\.\d+)?/,next:e.expression.set.operations,compile:function(e,t,r){e.value=Number(e.value),r.push(e)},parse:e.expression.fn.parse.push_value},{type:e.expression.type.bool,regex:/^(true|TRUE|false|FALSE)/,next:e.expression.set.operations,compile:function(e,t,r){e.value="true"===e.match[0].toLowerCase(),delete e.match,r.push(e)},parse:e.expression.fn.parse.push_value}],e.expression.resolve=function(e,t,r){return"function"==typeof e?e.apply(t,r||[]):e},e.expression.handler={},e.expression.extendType=function(t){e.expression.type[t]="Twig.expression.type."+t},e.expression.extend=function(t){if(!t.type)throw new e.Error("Unable to extend logic definition. No type provided for "+t);e.expression.handler[t.type]=t};for(;e.expression.definitions.length>0;)e.expression.extend(e.expression.definitions.shift());return e.expression.tokenize=function(t){var r,n,o,i,s,a,p=[],l=0,c=null,u=[];for(a=function(){var t=Array.prototype.slice.apply(arguments);t.pop(),t.pop();return e.log.trace("Twig.expression.tokenize","Matched a ",r," regular expression of ",t),c&&e.indexOf(c,r)<0?(u.push(r+" cannot follow a "+p[p.length-1].type+" at template:"+l+" near '"+t[0].substring(0,20)+"...'"),t[0]):e.expression.handler[r].validate&&!e.expression.handler[r].validate(t,p)?t[0]:(u=[],p.push({type:r,value:t[0],match:t}),s=!0,c=i,l+=t[0].length,e.expression.handler[r].transform?e.expression.handler[r].transform(t,p):"")},e.log.debug("Twig.expression.tokenize","Tokenizing expression ",t);t.length>0;){t=t.trim();for(r in e.expression.handler)if(e.expression.handler.hasOwnProperty(r)){for(i=e.expression.handler[r].next,n=e.expression.handler[r].regex,o=n instanceof Array?n:[n],s=!1;o.length>0;)n=o.pop(),t=t.replace(n,a);if(s)break}if(!s)throw u.length>0?new e.Error(u.join(" OR ")):new e.Error("Unable to parse '"+t+"' at template position"+l)}return e.log.trace("Twig.expression.tokenize","Tokenized to ",p),p},e.expression.compile=function(t){var r=t.value,n=e.expression.tokenize(r),o=null,i=[],s=[],a=null;for(e.log.trace("Twig.expression.compile: ","Compiling ",r);n.length>0;)o=n.shift(),a=e.expression.handler[o.type],e.log.trace("Twig.expression.compile: ","Compiling ",o),a.compile&&a.compile(o,s,i),e.log.trace("Twig.expression.compile: ","Stack is",s),e.log.trace("Twig.expression.compile: ","Output is",i);for(;s.length>0;)i.push(s.pop());return e.log.trace("Twig.expression.compile: ","Final output is",i),t.stack=i,delete t.value,t},e.expression.parse=function(t,r){var n=this;t instanceof Array||(t=[t]);var o=[],i=null;return e.forEach(t,function(t){i=e.expression.handler[t.type],i.parse&&i.parse.apply(n,[t,o,r])}),o.pop()},e}(s||{}),s=function(e){e.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};var t=function(e,t){if(void 0===t||null===t)return null;if(void 0!==t.indexOf)return e===t||""!==e&&t.indexOf(e)>-1;var r;for(r in t)if(t.hasOwnProperty(r)&&t[r]===e)return!0;return!1};return e.expression.operator.lookup=function(t,r){switch(t){case"..":case"not in":case"in":r.precidence=20,r.associativity=e.expression.operator.leftToRight;break;case",":r.precidence=18,r.associativity=e.expression.operator.leftToRight;break;case"?":case":":r.precidence=16,r.associativity=e.expression.operator.rightToLeft;break;case"or":r.precidence=14,r.associativity=e.expression.operator.leftToRight;break;case"and":r.precidence=13,r.associativity=e.expression.operator.leftToRight;break;case"==":case"!=":r.precidence=9,r.associativity=e.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":r.precidence=8,r.associativity=e.expression.operator.leftToRight;break;case"~":case"+":case"-":r.precidence=6,r.associativity=e.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":r.precidence=5,r.associativity=e.expression.operator.leftToRight;break;case"not":r.precidence=3,r.associativity=e.expression.operator.rightToLeft;break;default:throw new e.Error(t+" is an unknown operator.")}return r.operator=t,r},e.expression.operator.parse=function(r,n){e.log.trace("Twig.expression.operator.parse: ","Handling ",r);var o,i,s;switch(r){case":":break;case"?":s=n.pop(),i=n.pop(),o=n.pop(),o?n.push(i):n.push(s);break;case"+":i=parseFloat(n.pop()),o=parseFloat(n.pop()),n.push(o+i);break;case"-":i=parseFloat(n.pop()),o=parseFloat(n.pop()),n.push(o-i);break;case"*":i=parseFloat(n.pop()),o=parseFloat(n.pop()),n.push(o*i);break;case"/":i=parseFloat(n.pop()),o=parseFloat(n.pop()),n.push(o/i);break;case"//":i=parseFloat(n.pop()),o=parseFloat(n.pop()),n.push(parseInt(o/i));break;case"%":i=parseFloat(n.pop()),o=parseFloat(n.pop()),n.push(o%i);break;case"~":i=n.pop(),o=n.pop(),n.push((null!=o?o.toString():"")+(null!=i?i.toString():""));break;case"not":case"!":n.push(!n.pop());break;case"<":i=n.pop(),o=n.pop(),n.push(o<i);break;case"<=":i=n.pop(),o=n.pop(),n.push(o<=i);break;case">":i=n.pop(),o=n.pop(),n.push(o>i);break;case">=":i=n.pop(),o=n.pop(),n.push(o>=i);break;case"===":i=n.pop(),o=n.pop(),n.push(o===i);break;case"==":i=n.pop(),o=n.pop(),n.push(o==i);break;case"!==":i=n.pop(),o=n.pop(),n.push(o!==i);break;case"!=":i=n.pop(),o=n.pop(),n.push(o!=i);break;case"or":i=n.pop(),o=n.pop(),n.push(o||i);break;case"and":i=n.pop(),o=n.pop(),n.push(o&&i);break;case"**":i=n.pop(),o=n.pop(),n.push(Math.pow(o,i));break;case"not in":i=n.pop(),o=n.pop(),n.push(!t(o,i));break;case"in":i=n.pop(),o=n.pop(),n.push(t(o,i));break;case"..":i=n.pop(),o=n.pop(),n.push(e.functions.range(o,i));break;default:throw new e.Error(r+" is an unknown operator.")}},e}(s||{}),s=function(e){function t(e,t){var r=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&r===e}return e.filters={upper:function(e){return"string"!=typeof e?e:e.toUpperCase()},lower:function(e){return"string"!=typeof e?e:e.toLowerCase()},capitalize:function(e){return"string"!=typeof e?e:e.substr(0,1).toUpperCase()+e.toLowerCase().substr(1)},title:function(e){return"string"!=typeof e?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,r){return t+r.toUpperCase()})},length:function(t){return e.lib.is("Array",t)||"string"==typeof t?t.length:e.lib.is("Object",t)?void 0===t._keys?Object.keys(t).length:t._keys.length:0},reverse:function(e){if(t("Array",e))return e.reverse();if(t("String",e))return e.split("").reverse().join("");if(t("Object",e)){var r=e._keys||Object.keys(e).reverse();return e._keys=r,e}},sort:function(e){if(t("Array",e))return e.sort();if(t("Object",e)){delete e._keys;var r=Object.keys(e),n=r.sort(function(t,r){var n;return e[t]>e[r]==!(e[t]<=e[r])?e[t]>e[r]?1:e[t]<e[r]?-1:0:isNaN(n=parseFloat(e[t]))||isNaN(b1=parseFloat(e[r]))?"string"==typeof e[t]?e[t]>e[r].toString()?1:e[t]<e[r].toString()?-1:0:"string"==typeof e[r]?e[t].toString()>e[r]?1:e[t].toString()<e[r]?-1:0:null:n>b1?1:n<b1?-1:0});return e._keys=n,e}},keys:function(t){if(void 0!==t&&null!==t){var r=t._keys||Object.keys(t),n=[];return e.forEach(r,function(e){"_keys"!==e&&t.hasOwnProperty(e)&&n.push(e)}),n}},url_encode:function(e){if(void 0!==e&&null!==e){var t=encodeURIComponent(e);return t=t.replace("'","%27")}},join:function(r,n){if(void 0!==r&&null!==r){var o="",i=[],s=null;return n&&n[0]&&(o=n[0]),t("Array",r)?i=r:(s=r._keys||Object.keys(r),e.forEach(s,function(e){"_keys"!==e&&r.hasOwnProperty(e)&&i.push(r[e])})),i.join(o)}},"default":function(t,r){if(void 0!==r&&r.length>1)throw new e.Error("default filter expects one argument");return void 0===t||null===t||""===t?void 0===r?"":r[0]:t},json_encode:function(r){if(void 0===r||null===r)return"null";if("object"==("undefined"==typeof r?"undefined":i(r))&&t("Array",r))return o=[],e.forEach(r,function(t){o.push(e.filters.json_encode(t))}),"["+o.join(",")+"]";if("object"==("undefined"==typeof r?"undefined":i(r))){var n=r._keys||Object.keys(r),o=[];return e.forEach(n,function(t){o.push(JSON.stringify(t)+":"+e.filters.json_encode(r[t]))}),"{"+o.join(",")+"}"}return JSON.stringify(r)},merge:function(r,n){var o=[],i=0,s=[];if(t("Array",r)?e.forEach(n,function(e){t("Array",e)||(o={})}):o={},t("Array",o)||(o._keys=[]),t("Array",r)?e.forEach(r,function(e){o._keys&&o._keys.push(i),o[i]=e,i++}):(s=r._keys||Object.keys(r),e.forEach(s,function(e){o[e]=r[e],o._keys.push(e);var t=parseInt(e,10);!isNaN(t)&&t>=i&&(i=t+1)})),e.forEach(n,function(r){t("Array",r)?e.forEach(r,function(e){o._keys&&o._keys.push(i),o[i]=e,i++}):(s=r._keys||Object.keys(r),e.forEach(s,function(e){o[e]||o._keys.push(e),o[e]=r[e];var t=parseInt(e,10);!isNaN(t)&&t>=i&&(i=t+1)}))}),0===n.length)throw new e.Error("Filter merge expects at least one parameter");return o},date:function r(t,n){var r=e.functions.date(t),o=n&&n.length?n[0]:"F j, Y H:i";return e.lib.formatDate(r,o)},date_modify:function(t,r){if(void 0!==t&&null!==t){if(void 0===r||1!==r.length)throw new e.Error("date_modify filter expects 1 argument");var n,o=r[0];return e.lib.is("Date",t)&&(n=e.lib.strtotime(o,t.getTime()/1e3)),e.lib.is("String",t)&&(n=e.lib.strtotime(o,e.lib.strtotime(t))),e.lib.is("Number",t)&&(n=e.lib.strtotime(o,t)),new Date(1e3*n)}},replace:function(t,r){if(void 0!==t&&null!==t){var n,o=r[0];for(n in o)o.hasOwnProperty(n)&&"_keys"!==n&&(t=e.lib.replaceAll(t,n,o[n]));return t}},format:function(t,r){if(void 0!==t&&null!==t)return e.lib.vsprintf(t,r)},striptags:function(t){if(void 0!==t&&null!==t)return e.lib.strip_tags(t)},escape:function(t,r){if(void 0!==t&&null!==t){var n="html";if(r&&r.length&&r[0]!==!0&&(n=r[0]),"html"==n){var o=t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return e.Markup(o,"html")}if("js"==n){for(var o=t.toString(),i="",s=0;s<o.length;s++)if(o[s].match(/^[a-zA-Z0-9,\._]$/))i+=o[s];else{var a=o.charCodeAt(s);i+=a<128?"\\x"+a.toString(16).toUpperCase():e.lib.sprintf("\\u%04s",a.toString(16).toUpperCase())}return e.Markup(i,"js")}if("css"==n){for(var o=t.toString(),i="",s=0;s<o.length;s++)if(o[s].match(/^[a-zA-Z0-9]$/))i+=o[s];else{var a=o.charCodeAt(s);i+="\\"+a.toString(16).toUpperCase()+" "}return e.Markup(i,"css")}if("url"==n){var i=e.filters.url_encode(t);return e.Markup(i,"url")}if("html_attr"==n){for(var o=t.toString(),i="",s=0;s<o.length;s++)if(o[s].match(/^[a-zA-Z0-9,\.\-_]$/))i+=o[s];else if(o[s].match(/^[&<>"]$/))i+=o[s].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");else{var a=o.charCodeAt(s);i+=a<=31&&9!=a&&10!=a&&13!=a?"&#xFFFD;":a<128?e.lib.sprintf("&#x%02s;",a.toString(16).toUpperCase()):e.lib.sprintf("&#x%04s;",a.toString(16).toUpperCase())}return e.Markup(i,"html_attr")}throw new e.Error("escape strategy unsupported")}},e:function(t,r){return e.filters.escape(t,r)},nl2br:function(t){if(void 0!==t&&null!==t){var r="BACKSLASH_n_replace",n="<br />"+r;return t=e.filters.escape(t).replace(/\r\n/g,n).replace(/\r/g,n).replace(/\n/g,n),t=e.lib.replaceAll(t,r,"\n"),e.Markup(t)}},number_format:function(e,t){var r=e,n=t&&t[0]?t[0]:void 0,o=t&&void 0!==t[1]?t[1]:".",i=t&&void 0!==t[2]?t[2]:",";r=(r+"").replace(/[^0-9+\-Ee.]/g,"");var s=isFinite(+r)?+r:0,a=isFinite(+n)?Math.abs(n):0,p="",l=function(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r};return p=(a?l(s,a):""+Math.round(s)).split("."),p[0].length>3&&(p[0]=p[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(p[1]||"").length<a&&(p[1]=p[1]||"",p[1]+=new Array(a-p[1].length+1).join("0")),p.join(o)},trim:function(t,r){if(void 0!==t&&null!==t){var n,o=e.filters.escape(""+t);n=r&&r[0]?""+r[0]:" \n\r\t\f\x0B            ​\u2028\u2029　";for(var i=0;i<o.length;i++)if(n.indexOf(o.charAt(i))===-1){o=o.substring(i);break}for(i=o.length-1;i>=0;i--)if(n.indexOf(o.charAt(i))===-1){o=o.substring(0,i+1);break}return n.indexOf(o.charAt(0))===-1?o:""}},truncate:function(e,t){var r=30,n=!1,o="...";if(e+="",t&&(t[0]&&(r=t[0]),t[1]&&(n=t[1]),t[2]&&(o=t[2])),e.length>r){if(n&&(r=e.indexOf(" ",r),r===-1))return e;e=e.substr(0,r)+o}return e},slice:function(t,r){if(void 0!==t&&null!==t){if(void 0===r||r.length<1)throw new e.Error("slice filter expects at least 1 argument");var n=r[0]||0,o=r.length>1?r[1]:t.length,i=n>=0?n:Math.max(t.length+n,0);if(e.lib.is("Array",t)){for(var s=[],a=i;a<i+o&&a<t.length;a++)s.push(t[a]);return s}if(e.lib.is("String",t))return t.substr(i,o);throw new e.Error("slice filter expects value to be an array or string")}},abs:function(e){if(void 0!==e&&null!==e)return Math.abs(e)},first:function(e){if(t("Array",e))return e[0];if(t("Object",e)){if("_keys"in e)return e[e._keys[0]]}else if("string"==typeof e)return e.substr(0,1)},split:function n(t,r){if(void 0!==t&&null!==t){if(void 0===r||r.length<1||r.length>2)throw new e.Error("split filter expects 1 or 2 argument");if(e.lib.is("String",t)){var o=r[0],i=r[1],n=t.split(o);if(void 0===i)return n;if(i<0)return t.split(o,n.length+i);var s=[];if(""==o)for(;n.length>0;){for(var a="",p=0;p<i&&n.length>0;p++)a+=n.shift();s.push(a)}else{for(var p=0;p<i-1&&n.length>0;p++)s.push(n.shift());n.length>0&&s.push(n.join(o))}return s}throw new e.Error("split filter expects value to be a string")}},last:function(t){if(e.lib.is("Object",t)){var r;return r=void 0===t._keys?Object.keys(t):t._keys,t[r[r.length-1]]}return t[t.length-1]},raw:function(t){return e.Markup(t)},batch:function(t,r){var n,o,i,s=r.shift(),a=r.shift();if(!e.lib.is("Array",t))throw new e.Error("batch filter expects items to be an array");if(!e.lib.is("Number",s))throw new e.Error("batch filter expects size to be a number");if(s=Math.ceil(s),n=e.lib.chunkArray(t,s),a&&t.length%s!=0){for(o=n.pop(),i=s-o.length;i--;)o.push(a);n.push(o)}return n},round:function(t,r){r=r||[];var n=r.length>0?r[0]:0,o=r.length>1?r[1]:"common";if(t=parseFloat(t),n&&!e.lib.is("Number",n))throw new e.Error("round filter expects precision to be a number");if("common"===o)return e.lib.round(t,n);if(!e.lib.is("Function",Math[o]))throw new e.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[o](t*Math.pow(10,n))/Math.pow(10,n)}},e.filter=function(t,r,n){if(!e.filters[t])throw"Unable to find filter "+t;return e.filters[t].apply(this,[r,n])},e.filter.extend=function(t,r){e.filters[t]=r},e}(s||{}),s=function(t){var r='Template "{name}" is not defined.';return t.functions={range:function(e,t,r){var n,o,i,s=[],a=r||1,p=!1;if(isNaN(e)||isNaN(t)?isNaN(e)&&isNaN(t)?(p=!0,n=e.charCodeAt(0),o=t.charCodeAt(0)):(n=isNaN(e)?0:e,o=isNaN(t)?0:t):(n=parseInt(e,10),o=parseInt(t,10)),i=!(n>o))for(;n<=o;)s.push(p?String.fromCharCode(n):n),n+=a;else for(;n>=o;)s.push(p?String.fromCharCode(n):n),n-=a;return s},cycle:function(e,t){var r=t%e.length;return e[r]},dump:function(){var e="\n",r="  ",n=0,o="",s=Array.prototype.slice.call(arguments),a=function(e){for(var t="";e>0;)e--,t+=r;return t},p=function(t){o+=a(n),"object"===("undefined"==typeof t?"undefined":i(t))?l(t):"function"==typeof t?o+="function()"+e:"string"==typeof t?o+="string("+t.length+') "'+t+'"'+e:"number"==typeof t?o+="number("+t+")"+e:"boolean"==typeof t&&(o+="bool("+t+")"+e)},l=function(t){var r;if(null===t)o+="NULL"+e;else if(void 0===t)o+="undefined"+e;else if("object"===("undefined"==typeof t?"undefined":i(t))){o+=a(n)+("undefined"==typeof t?"undefined":i(t)),n++,o+="("+function(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r}(t)+") {"+e;for(r in t)o+=a(n)+"["+r+"]=> "+e,p(t[r]);n--,o+=a(n)+"}"+e}else p(t)};return 0==s.length&&s.push(this.context),t.forEach(s,function(e){l(e)}),o},date:function(e,r){var n;if(void 0===e)n=new Date;else if(t.lib.is("Date",e))n=e;else if(t.lib.is("String",e))n=e.match(/^[0-9]+$/)?new Date(1e3*e):new Date(1e3*t.lib.strtotime(e));else{if(!t.lib.is("Number",e))throw new t.Error("Unable to parse date "+e);n=new Date(1e3*e)}return n},block:function(e){return this.originalBlockTokens[e]?t.logic.parse.apply(this,[this.originalBlockTokens[e],this.context]).output:this.blocks[e]},parent:function(){return t.placeholders.parent},attribute:function(e,r,n){return t.lib.is("Object",e)&&e.hasOwnProperty(r)?"function"==typeof e[r]?e[r].apply(void 0,n):e[r]:e[r]||void 0},max:function(e){return t.lib.is("Object",e)?(delete e._keys,t.lib.max(e)):t.lib.max.apply(null,arguments)},min:function(e){return t.lib.is("Object",e)?(delete e._keys,t.lib.min(e)):t.lib.min.apply(null,arguments)},template_from_string:function(e){return void 0===e&&(e=""),t.Templates.parsers.twig({options:this.options,data:e})},random:function(e){function r(e){var t=Math.floor(Math.random()*n),r=[0,e],o=Math.min.apply(null,r),i=Math.max.apply(null,r);return o+Math.floor((i-o+1)*t/n)}var n=2147483648;if(t.lib.is("Number",e))return r(e);if(t.lib.is("String",e))return e.charAt(r(e.length-1));if(t.lib.is("Array",e))return e[r(e.length-1)];if(t.lib.is("Object",e)){var o=Object.keys(e);return e[o[r(o.length-1)]]}return r(n-1)},source:function(n,i){var s,a,p,l=!1,c="undefined"!=typeof o&&"undefined"!=typeof o.exports&&"undefined"==typeof window;c?(a="fs",p=e+"/"+n):(a="ajax",p=n);var u={id:n,path:p,method:a,parser:"source",async:!1,fetchTemplateSource:!0};"undefined"==typeof i&&(i=!1);try{s=t.Templates.loadRemote(n,u),"undefined"==typeof s||null===s?s="":l=!0}catch(f){t.log.debug("Twig.functions.source: ","Problem loading template  ",f)}return l||i?s:r.replace("{name}",n)}},t._function=function(e,r,n){if(!t.functions[e])throw"Unable to find function "+e;return t.functions[e](r,n)},t._function.extend=function(e,r){t.functions[e]=r},t}(s||{}),s=function(e){return e.path={},e.path.parsePath=function(t,r){var n=null,r=r||"";if("object"===("undefined"==typeof t?"undefined":i(t))&&"object"===i(t.options)&&(n=t.options.namespaces),"object"===("undefined"==typeof n?"undefined":i(n))&&r.indexOf("::")>0||r.indexOf("@")>=0){for(var o in n)n.hasOwnProperty(o)&&(r=r.replace(o+"::",n[o]),r=r.replace("@"+o,n[o]));return r}return e.path.relativePath(t,r)},e.path.relativePath=function(t,n){var o,i,s,a="/",p=[],n=n||"";if(t.url)o="undefined"!=typeof t.base?t.base+("/"===t.base.charAt(t.base.length-1)?"":"/"):t.url;else if(t.path){var l=r(17),c=l.sep||a,u=new RegExp("^\\.{1,2}"+c.replace("\\","\\\\"));n=n.replace(/\//g,c),void 0!==t.base&&null==n.match(u)?(n=n.replace(t.base,""),o=t.base+c):o=l.normalize(t.path),o=o.replace(c+c,c),a=c}else{if(!t.name&&!t.id||!t.method||"fs"===t.method||"ajax"===t.method)throw new e.Error("Cannot extend an inline template.");o=t.base||t.name||t.id}for(i=o.split(a),i.pop(),i=i.concat(n.split(a));i.length>0;)s=i.shift(),"."==s||(".."==s&&p.length>0&&".."!=p[p.length-1]?p.pop():p.push(s));return p.join(a)},e}(s||{}),s=function(e){return e.tests={empty:function(e){if(null===e||void 0===e)return!0;if("number"==typeof e)return!1;if(e.length&&e.length>0)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},odd:function(e){return e%2===1},even:function(e){return e%2===0},divisibleby:function(e,t){return e%t[0]===0},defined:function(e){return void 0!==e},none:function(e){return null===e},"null":function(e){return this.none(e)},sameas:function(e,t){return e===t[0]},iterable:function(t){return t&&(e.lib.is("Array",t)||e.lib.is("Object",t))}},e.test=function(t,r,n){if(!e.tests[t])throw"Test "+t+" is not defined.";return e.tests[t](r,n)},e.test.extend=function(t,r){e.tests[t]=r},e}(s||{}),s=function(e){return e.exports={VERSION:e.VERSION},e.exports.twig=function(t){var r=t.id,n={strict_variables:t.strict_variables||!1,autoescape:null!=t.autoescape&&t.autoescape||!1,allowInlineIncludes:t.allowInlineIncludes||!1,rethrow:t.rethrow||!1,namespaces:t.namespaces};if(e.cache&&r&&e.validateId(r),void 0!==t.debug&&(e.debug=t.debug),void 0!==t.trace&&(e.trace=t.trace),void 0!==t.data)return e.Templates.parsers.twig({data:t.data,path:t.hasOwnProperty("path")?t.path:void 0,module:t.module,id:r,options:n});if(void 0!==t.ref){if(void 0!==t.id)throw new e.Error("Both ref and id cannot be set on a twig.js template.");return e.Templates.load(t.ref)}if(void 0!==t.method){if(!e.Templates.isRegisteredLoader(t.method))throw new e.Error('Loader for "'+t.method+'" is not defined.');return e.Templates.loadRemote(t.name||t.href||t.path||r||void 0,{id:r,method:t.method,parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:n},t.load,t.error)}return void 0!==t.href?e.Templates.loadRemote(t.href,{id:r,method:"ajax",parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:n},t.load,t.error):void 0!==t.path?e.Templates.loadRemote(t.path,{id:r,method:"fs",
parser:t.parser||"twig",base:t.base,module:t.module,precompiled:t.precompiled,async:t.async,options:n},t.load,t.error):void 0},e.exports.extendFilter=function(t,r){e.filter.extend(t,r)},e.exports.extendFunction=function(t,r){e._function.extend(t,r)},e.exports.extendTest=function(t,r){e.test.extend(t,r)},e.exports.extendTag=function(t){e.logic.extend(t)},e.exports.extend=function(t){t(e)},e.exports.compile=function(t,r){var n,o=r.filename,i=r.filename;return n=new e.Template({data:t,path:i,id:o,options:r.settings["twig options"]}),function(e){return n.render(e)}},e.exports.renderFile=function(t,r,n){"function"==typeof r&&(n=r,r={}),r=r||{};var o=r.settings||{},i={path:t,base:o.views,load:function(e){n(null,e.render(r))}},s=o["twig options"];if(s)for(var a in s)s.hasOwnProperty(a)&&(i[a]=s[a]);e.exports.twig(i)},e.exports.__express=e.exports.renderFile,e.exports.cache=function(t){e.cache=t},e.exports.path=e.path,e}(s||{}),s=function(e){return e.compiler={module:{}},e.compiler.compile=function(t,r){var n,o=JSON.stringify(t.tokens),i=t.id;if(r.module){if(void 0===e.compiler.module[r.module])throw new e.Error("Unable to find module type "+r.module);n=e.compiler.module[r.module](i,o,r.twig)}else n=e.compiler.wrap(i,o);return n},e.compiler.module={amd:function(t,r,n){return'define(["'+n+'"], function (Twig) {\n\tvar twig, templates;\ntwig = Twig.twig;\ntemplates = '+e.compiler.wrap(t,r)+"\n\treturn templates;\n});"},node:function(t,r){return'var twig = require("twig").twig;\nexports.template = '+e.compiler.wrap(t,r)},cjs2:function(t,r,n){return'module.declare([{ twig: "'+n+'" }], function (require, exports, module) {\n\tvar twig = require("twig").twig;\n\texports.template = '+e.compiler.wrap(t,r)+"\n});"}},e.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},e}(s||{});"undefined"!=typeof o&&o.declare?o.declare([],function(e,t,r){for(key in s.exports)s.exports.hasOwnProperty(key)&&(t[key]=s.exports[key])}):(n=function(){return s.exports}.call(t,r,t,o),!(void 0!==n&&(o.exports=n)))}).call(t,"/",r(15)(e))},function(e,t){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict"},function(e,t,r){(function(e){"use strict";function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return o.exec(e).slice(1)};t.resolve=function(){for(var t="",o=!1,i=arguments.length-1;i>=-1&&!o;i--){var s=i>=0?arguments[i]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,o="/"===s.charAt(0))}return t=r(n(t.split("/"),function(e){return!!e}),!o).join("/"),(o?"/":"")+t||"."},t.normalize=function(e){var o=t.isAbsolute(e),i="/"===s(e,-1);return e=r(n(e.split("/"),function(e){return!!e}),!o).join("/"),e||o||(e="."),e&&i&&(e+="/"),(o?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var o=n(e.split("/")),i=n(r.split("/")),s=Math.min(o.length,i.length),a=s,p=0;p<s;p++)if(o[p]!==i[p]){a=p;break}for(var l=[],p=a;p<o.length;p++)l.push("..");return l=l.concat(i.slice(a)),l.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return i(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(t,r(18))},function(e,t){"use strict";function r(){u&&l&&(u=!1,l.length?c=l.concat(c):f=-1,c.length&&n())}function n(){if(!u){var e=s(r);u=!0;for(var t=c.length;t;){for(l=c,c=[];++f<t;)l&&l[f].run();f=-1,t=c.length}l=null,u=!1,a(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var s,a,p=e.exports={};!function(){try{s=setTimeout}catch(e){s=function(){throw new Error("setTimeout is not defined")}}try{a=clearTimeout}catch(e){a=function(){throw new Error("clearTimeout is not defined")}}}();var l,c=[],u=!1,f=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new o(e,t)),1!==c.length||u||s(n,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=i,p.addListener=i,p.once=i,p.off=i,p.removeListener=i,p.removeAllListeners=i,p.emit=i,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=n(o),s=r(7),a=n(s),p=r(20),l=n(p);t["default"]={insertToDOM:function(e,t){var r=$(e).find(".report-battle");if(0==r.find(".js-wt-battle").size()){var n=(0,l["default"])($.extend(i["default"],{sendWarLoggerButtonClass:"js-wt-battle",reportId:t,loggerLink:a["default"].getLogger("warlogger")}));r.append(n)}}}},function(e,t,r){var n=r(14).twig,o=n({id:"e:\\YandexDisk\\domains\\projects\\wofh-tools\\user.js\\source\\modules\\ui\\war-logger-button\\button.twig",data:[{type:"raw",value:'<div>\n    <button class="button1 -type-green '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"sendWarLoggerButtonClass",match:["sendWarLoggerButtonClass"]}]},{type:"raw",value:'" data-id="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"reportId",match:["reportId"]}]},{type:"raw",value:'">\n        <span>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_ToWarLogger",match:["text_ToWarLogger"]}]},{type:"raw",value:'</span>\n    </button>\n    <div class="-defVal">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerLink",match:["loggerLink"]}]},{type:"raw",value:"</div>\n</div>\n"}],allowInlineIncludes:!0,rethrow:!0});e.exports=function(e){return o.render(e)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=n(o),s=r(7),a=(n(s),r(22)),p=n(a),l=r(23),c=n(l),u=r(8),f=n(u);t["default"]={getHtml:function(e){var t=new c["default"]({loggerTitle:i["default"].text_SciLogger,loggerType:"scilogger",loggerDefaultLink:"wofh-tools.ru/sci",loggerPlaceholderAdd:i["default"].text_ADD_SCI_HINT}),r=new c["default"]({loggerTitle:i["default"].text_WarLogger,loggerType:"warlogger",loggerDefaultLink:"wofh-tools.ru/log",loggerPlaceholderAdd:i["default"].text_ADD_WAR_HINT});return(0,p["default"])($.extend(i["default"],{accountId:e.account[0],worldSign:f["default"].domainToSign(e.domain),isNewTown:"new"==wofh.version.town?"-hover":"",sciLoggerPanel:t.render(),warLoggerPanel:r.render()}))}}},function(e,t,r){var n=r(14).twig,o=n({id:"e:\\YandexDisk\\domains\\projects\\wofh-tools\\user.js\\source\\modules\\ui\\settings\\settings.twig",data:[{type:"raw",value:'<div class="wt-options-window">\n    <div class="wt-sections">\n        <div class="FM1 Fb1 Ft1 Fbg1">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"sciLoggerPanel",match:["sciLoggerPanel"]}]},{type:"raw",value:'</div>\n        <div class="FM1 Fb1 Ft1 Fbg1">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"warLoggerPanel",match:["warLoggerPanel"]}]},{type:"raw",value:'</div>\n    </div>\n\n    <div class="wt-options-item wt-options-item--between">\n        <a href="http://wofh-tools.ru/stat/'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"worldSign",match:["worldSign"]}]},{type:"raw",value:"/accounts/"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"accountId",match:["accountId"]}]},{type:"raw",value:'/"\n           target="_blank" class="button1"><span>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_Statistic",match:["text_Statistic"]}]},{type:"raw",value:'</span></a>\n\n        <div>\n            <a href="/newtown" class="button1 -type-green '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"isNewTown",match:["isNewTown"]}]},{type:"raw",value:'"><span>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_HybridInterface",match:["text_HybridInterface"]}]},{type:"raw",value:'</span></a>\n            <a href="/oldmap" class="button1 -type-green '},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"isOldMap",match:["isOldMap"]}]},{type:"raw",value:'"><span>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_ClassicMap",match:["text_ClassicMap"]}]},{type:"raw",value:"</span></a>\n        </div>\n    </div>\n</div>\n"}],allowInlineIncludes:!0,rethrow:!0});e.exports=function(e){return o.render(e)}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(11),a=n(s),p=r(7),l=n(p),c=r(24),u=n(c),f=function(){function e(t){o(this,e),this.data=t,this.data.loggers=l["default"].getLoggers(t.loggerType),this.data.selectedLogger=l["default"].getLogger(t.loggerType)}return i(e,[{key:"render",value:function(){return(0,u["default"])($.extend(a["default"],this.data))}}]),e}();$(document).on("click",".js-wt-logger-add",function(){var e=$(this).data("type"),t=$(".js-wt-logger-new").filter('[data-type="'+e+'"]'),r=$(".js-wt-"+e+"-list"),n=$.trim(t.val());return n&&!l["default"].existsLogger(e,n)&&(l["default"].addLogger(e,n),t.val(""),r.append("<option>"+n+"</option>")),!1}),$(document).on("click",".js-wt-logger-remove",function(){var e=$(this).data("type"),t=$(".js-wt-"+e+"-list"),r=t.find("option").filter(":selected"),n=r.text();if("wofh-tools.ru/sci"!=n&&"wofh-tools.ru/log"!=n)return r.remove(),t.find("option").filter(":first").attr("selected",!0),t.trigger("change"),l["default"].removeLogger(e,n),!1}),$(document).on("change",".js-wt-logger-list",function(){var e=$(this),t=e.find("option").filter(":selected").text(),r=e.data("type");l["default"].selectLogger(r,t)}),t["default"]=f},function(e,t,r){var n=r(14).twig,o=n({id:"e:\\YandexDisk\\domains\\projects\\wofh-tools\\user.js\\source\\modules\\ui\\settings\\logger\\logger.twig",data:[{type:"raw",value:"<h3>"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerTitle",match:["loggerTitle"]}]},{type:"raw",value:'</h3>\n\n<div class="wt-panel-body">\n    <div class="wt-options-item">\n        <div class="wt-input">\n            <select class="opt_s js-wt-logger-list js-wt-'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerType",match:["loggerType"]}]},{type:"raw",value:'-list" data-type="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerType",match:["loggerType"]}]},{type:"raw",value:'">\n                <option>'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerDefaultLink",match:["loggerDefaultLink"]}]},{type:"raw",value:"</option>\n                "},{type:"logic",token:{type:"Twig.logic.type.for",key_var:null,value_var:"loggerLink",expression:[{type:"Twig.expression.type.variable",value:"loggers",match:["loggers"]}],output:[{type:"raw",value:"                    <option "},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"selectedLogger",match:["selectedLogger"]},{type:"Twig.expression.type.variable",value:"loggerLink",match:["loggerLink"]},{type:"Twig.expression.type.operator.binary",value:"==",precidence:9,associativity:"leftToRight",operator:"=="},{type:"Twig.expression.type.string",value:"selected"},{type:"Twig.expression.type.string",value:""},{type:"Twig.expression.type.operator.binary",value:"?",precidence:16,associativity:"rightToLeft",operator:"?"}]},{type:"raw",value:">"},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerLink",match:["loggerLink"]}]},{type:"raw",value:"</option>\n                "}]}},{type:"raw",value:'            </select>\n        </div>\n        <button class="button1 js-wt-logger-remove" data-type="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerType",match:["loggerType"]}]},{type:"raw",value:'">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_Remove",match:["text_Remove"]}]},{type:"raw",value:'</button>\n    </div>\n    <div class="wt-options-item">\n        <div class="wt-input">\n            <input class="opt_i js-wt-logger-new" data-type="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerType",match:["loggerType"]}]},{type:"raw",value:'" type="text" placeholder="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerPlaceholderAdd",match:["loggerPlaceholderAdd"]}]},{type:"raw",value:'">\n        </div>\n        <button class="button1 js-wt-logger-add" data-type="'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"loggerType",match:["loggerType"]}]},{type:"raw",value:'">'},{type:"output",stack:[{type:"Twig.expression.type.variable",value:"text_Add",match:["text_Add"]}]},{type:"raw",value:"</button>\n    </div>\n</div>\n"}],allowInlineIncludes:!0,rethrow:!0});e.exports=function(e){return o.render(e)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});/**
	 * wofh-tools.user.js
	 * @since       02.07.2016 21:30
	 * @author      delphinpro <delphinpro@gmail.com>
	 * @copyright   Copyright © 2016 delphinpro
	 * @license     Licensed under the MIT license
	 */
var r="2.0.6";t["default"]=r}]);